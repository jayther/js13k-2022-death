<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Death Estate</title>
      <style>
        a,abbr,acronym,address,applet,article,aside,audio,b,big,blockquote,body,canvas,caption,center,cite,code,dd,del,details,dfn,div,dl,dt,em,embed,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,html,i,iframe,img,ins,kbd,label,legend,li,mark,menu,nav,object,ol,output,p,pre,q,ruby,s,samp,section,small,span,strike,strong,sub,summary,sup,table,tbody,td,tfoot,th,thead,time,tr,tt,u,ul,var,video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:after,blockquote:before,q:after,q:before{content:'';content:none}table{border-collapse:collapse;border-spacing:0}
      </style>
  </head>
  <body>
      <script>
        !function(){"use strict";const t=Math.PI,n=t=>t<0?-t:t,s=(t,n)=>t<n?t:n,e=(t,n)=>t>n?t:n,i=t=>t<0?-1:1,o=(t,n=0,s=1)=>t<n?n:t>s?s:t,r=(t,n=0,s=1)=>s-n?o((t-n)/(s-n)):0,h=(t,n=0,s=1)=>n+o(t)*(s-n),c=(t=1,n=0)=>n+(t-n)*Math.random(),u=(t=1,n=0)=>0|c(t,n),a=(t=0,n)=>null==t.x?new l(t,null==n?t:n):new l(t.x,t.y);class l{constructor(t=0,n=0){this.x=t,this.y=n}t(){return new l(this.x,this.y)}add(t){return new l(this.x+t.x,this.y+t.y)}i(t){return new l(this.x-t.x,this.y-t.y)}multiply(t){return new l(this.x*t.x,this.y*t.y)}o(t){return new l(this.x/t.x,this.y/t.y)}scale(t){return new l(this.x*t,this.y*t)}length(){return this.h()**.5}h(){return this.x**2+this.y**2}u(t){return this.l(t)**.5}l(t){return(this.x-t.x)**2+(this.y-t.y)**2}normalize(t=1){const n=this.length();return n?this.scale(t/n):new l(0,t)}g(t=1){const n=this.length();return n>t?this.scale(t/n):this}m(t){return this.x*t.x+this.y*t.y}v(t){return this.x*t.y-this.y*t.x}angle(){return Math.atan2(this.x,this.y)}p(t=0,n=1){return this.x=n*Math.sin(t),this.y=n*Math.cos(t),this}rotate(t){const n=Math.cos(t),s=Math.sin(t);return new l(this.x*n-this.y*s,this.x*s+this.y*n)}direction(){return n(this.x)>n(this.y)?this.x<0?3:1:this.y<0?2:0}M(){return new l(this.y,-this.x)}floor(){return new l(Math.floor(this.x),Math.floor(this.y))}S(){return n(this.x*this.y)}k(t,n){return this.add(t.i(this).scale(o(n)))}A(t){return this.x>=0&&this.y>=0&&this.x<t.x&&this.y<t.y}toString(t=3){return`(${(this.x<0?"":" ")+this.x.toFixed(t)},${(this.y<0?"":" ")+this.y.toFixed(t)} )`}}class f{constructor(t=1,n=1,s=1,e=1){this.r=t,this.C=n,this.b=s,this.a=e}t(){return new f(this.r,this.C,this.b,this.a)}add(t){return new f(this.r+t.r,this.C+t.C,this.b+t.b,this.a+t.a)}i(t){return new f(this.r-t.r,this.C-t.C,this.b-t.b,this.a-t.a)}multiply(t){return new f(this.r*t.r,this.C*t.C,this.b*t.b,this.a*t.a)}o(t){return new f(this.r/t.r,this.C/t.C,this.b/t.b,this.a/t.a)}scale(t,n=t){return new f(this.r*t,this.C*t,this.b*t,this.a*n)}R(){return new f(o(this.r),o(this.C),o(this.b),o(this.a))}k(t,n){return this.add(t.i(this).scale(o(n)))}$(t=0,n=0,s=1,e=1){const i=s<.5?s*(1+n):s+n-s*n,o=2*s-i,r=(t,n,s)=>(s=(s%1+1)%1)<1/6?t+6*(n-t)*s:s<.5?n:s<2/3?t+(n-t)*(2/3-s)*6:t;return this.r=r(o,i,t+1/3),this.C=r(o,i,t),this.b=r(o,i,t-1/3),this.a=e,this}H(){const t=this.r,n=this.C,s=this.b,e=this.a,i=Math.max(t,n,s),o=Math.min(t,n,s),r=(i+o)/2;let h=0,c=0;if(i!=o){let e=i-o;c=r>.5?e/(2-i-o):e/(i+o),t==i?h=(n-s)/e+(n<s?6:0):n==i?h=(s-t)/e+2:s==i&&(h=(t-n)/e+4)}return[h/6,c,r,e]}D(t=.05,n=0){return new f(this.r+c(t,-t),this.C+c(t,-t),this.b+c(t,-t),this.a+c(n,-n)).R()}toString(){return`rgb(${255*this.r|0},${255*this.C|0},${255*this.b|0},${this.a})`}F(){return(255*this.r|0)+(255*this.C<<8)+(255*this.b<<16)+(255*this.a<<24)}T(t){const n=n=>parseInt(t.slice(n,n+2),16)/255;return this.r=n(1),this.C=n(3),this.b=n(5),this.a=1,this}P(){const t=t=>((t=255*t|0)<16?"0":"")+t.toString(16);return"#"+t(this.r)+t(this.C)+t(this.b)}}let d=a(1920,1200),w=a(),g=a(16),m=.3,v=(a(1),a()),p=e(g.x,g.y);let M=.5;let y,S,k=[],b=[],A=0,C=0,R=0,$=0,H=0;const D="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)";function F(){b=k.filter((t=>t.U));const t=n=>{if(!n.W){n.update();for(const s of n.children)t(s)}};for(const n of k)n.parent||t(n);k=k.filter((t=>!t.W)),C=++A/60}const T=new Image;let x,P,U,W,B=a();const z=t=>t.add(a(.5)).i(B.scale(.5)).multiply(a(1/p,-1/p)).add(v),I=t=>t.i(v).multiply(a(p,-p)).add(B.scale(.5)).i(a(.5));function L(t,n=a(1),s=-1,e=g,i=new f,o=0,r,h=new f(0,0,0,0),c=1){if(c)if(s<0||!T.width)At(t.x,t.y,n.x,n.y,o,0,0,0,0,0,i.F());else{const c=y.x/e.x|0,u=e.x/y.x,a=e.y/y.y,l=s%c*u,f=(s/c|0)*a;At(t.x,t.y,r?-n.x:n.x,n.y,o,l+S.x,f+S.y,l-S.x+u,f-S.y+a,i.F(),h.F())}else!function(t,n,s,e,i,o=P){t=I(t),n=n.scale(p),o.save(),o.translate(t.x+.5|0,t.y-.5|0),o.rotate(s),o.scale(e?-n.x:n.x,n.y),i(o),o.restore()}(t,n,o,r,(t=>{if(s<0)t.fillStyle=i,t.fillRect(-.5,-.5,1,1);else{const n=y.x/e.x|0,o=s%n*e.x+m,r=(s/n|0)*e.y+m,h=e.x-.6,c=e.y-.6;t.globalAlpha=i.a,t.drawImage(T,o,r,h,c,-.5,-.5,1,1)}}))}function N(t,n,s,e,i){L(t,n,-1,g,s,e,0,0,i)}function _(t,n,s,e,i){!function(t,n=a(1),s,e,i,o,r,h,c){L(z(t),n.scale(1/p),s,e,i,o,r,h,c)}(t,n,-1,g,s,e,0,0,i)}function q(t,n,s=1,e=new f,i=0,o=new f(0,0,0),r="center",h="arial"){W.fillStyle=e,W.lineWidth=i,W.strokeStyle=o,W.textAlign=r,W.font=s+"px "+h,W.textBaseline="middle",W.lineJoin="round",n=n.t(),(t+"").split("\n").forEach((t=>{i&&W.strokeText(t,n.x,n.y),W.fillText(t,n.x,n.y),n.y+=s}))}function G(t,n,s=1,e,i,o,r,h){q(t,I(n),s*p,e,i*p,o,r,h)}const J=(t,n=0)=>Z[n]&&1&Z[n][t]?1:0,O=J,j=(t,n=0)=>Z[n]&&2&Z[n][t]?1:0,E=(t,n=0)=>Z[n]&&4&Z[n][t]?1:0;let Y=a(),K=a(),Q=0,V=0;const X=(t,n=0)=>J(t,n+1);let Z=[[]];function tt(){document.hasFocus()||(Z=[[]]),Y=z(K),function(){0;if(!navigator.getGamepads||!document.hasFocus())return;const t=navigator.getGamepads();for(let n=t.length;n--;){const s=t[n],e=Z[n+1]||(Z[n+1]=[]),i=it[n]||(it[n]=[]);if(s){const t=.3,o=.8,h=n=>n>t?r(n,t,o):n<-t?-r(-n,t,o):0;for(let t=0;t<s.axes.length-1;t+=2)i[t>>1]=a(h(s.axes[t]),h(-s.axes[t+1])).g();for(let t=s.buttons.length;t--;){const i=s.buttons[t];e[t]=i.pressed?1+2*!X(t,n):4*X(t,n),V|=!n&&i.pressed}{const t=a(X(15,n)-X(14,n),X(12,n)-X(13,n));t.h()&&(i[0]=t.g())}}}}()}function nt(){for(const t of Z)for(const n in t)t[n]&=1;Q=0}onkeydown=t=>{t.repeat||(Z[V=0][st(t.keyCode)]=3)},onkeyup=t=>{Z[0][st(t.keyCode)]=4};const st=t=>87==t?38:83==t?40:65==t?37:68==t?39:t;onmousedown=t=>{Z[V=0][t.button]=3,onmousemove(t),t.button&&t.preventDefault()},onmouseup=t=>Z[0][t.button]=2&Z[0][t.button]|4,onmousemove=t=>K=et(t),onwheel=t=>t.ctrlKey||(Q=i(t.deltaY)),oncontextmenu=t=>!1;const et=t=>{if(!x)return a();const n=x.getBoundingClientRect();return a(x.width,x.height).multiply(a(r(t.x,n.left,n.right),r(t.y,n.top,n.bottom)))},it=[];const ot=void 0!==window.ontouchstart;if(ot){let t,n;ontouchstart=ontouchmove=ontouchend=s=>{s.button=0;const e=s.touches.length;return e?(n||ht(0,n=1),s.x=s.touches[0].clientX,s.y=s.touches[0].clientY,t?onmousemove(s):onmousedown(s)):t&&onmouseup(s),t=e,!s.cancelable}}let rt;new class{constructor(t){this.time=null==t?void 0:C+t,this.setTime=t}set(t=0){this.time=C+t,this.setTime=t}B(){this.time=void 0}I(){return null!=this.time}active(){return C<=this.time}L(){return C>this.time}get(){return this.I()?C-this.time:0}N(){return this.I()?r(this.time-C,this.setTime,0):0}toString(){0}},a();const ht=(...t)=>function(t,n=1,s=1,e=0,i=0){if(rt||(rt=new(window.AudioContext||webkitAudioContext)),rt.resume(),"running"!=rt.state)return;const r=rt.createBuffer(t.length,t[0].length,ct),h=rt.createBufferSource();t.forEach(((t,n)=>r.getChannelData(n).set(t))),h.buffer=r,h.playbackRate.value=s,h.loop=i;const c=rt.createGain();return c.gain.value=.5*n,c.connect(rt.destination),(window.StereoPannerNode?h.connect(new StereoPannerNode(rt,{pan:o(e,-1,1)})):h).connect(c),h.start(),h}([ut(...t)]),ct=44100;function ut(o=1,r=.05,h=220,u=0,a=0,l=.1,f=0,d=1,w=0,g=0,m=0,v=0,p=0,M=0,y=0,S=0,k=0,b=1,A=0,C=0){let R,$,H=2*t,D=w*=500*H/ct/ct,F=[],T=h*=(1+r*c(-1,1))*H/ct,x=0,P=0,U=0,W=1,B=0,z=0,I=0;for(g*=500*H/ct**3,y*=H/ct,m*=H/ct,v*=ct,p=p*ct|0,$=(u=u*ct+9)+(A*=ct)+(a*=ct)+(l*=ct)+(k*=ct)|0;U<$;F[U++]=I)++z%(100*S|0)||(I=f?f>1?f>2?f>3?Math.sin((x%H)**3):e(s(Math.tan(x),1),-1):1-(2*x/H%2+2)%2:1-4*n(Math.round(x/H)-x/H):Math.sin(x),I=(p?1-C+C*Math.sin(H*U/p):1)*i(I)*n(I)**d*o*.5*(U<u?U/u:U<u+A?1-(U-u)/A*(1-b):U<u+A+a?b:U<$-k?($-U-k)/l*b:0),I=k?I/2+(k>U?0:(U<$-k?1:($-U)/k)*F[U-k|0]/2):I),R=(h+=w+=g)*Math.cos(y*P++),x+=R-R*M*(1-1e9*(Math.sin(U)+1)%2),W&&++W>v&&(h+=m,T+=m,W=0),!p||++B%p||(h=T,w=D,W=W||1);return F}a();let at,lt,ft,dt,wt,gt,mt,vt,pt,Mt,yt,St=[];function kt(t,n){const s=ft.createShader(n);return ft.shaderSource(s,t),ft.compileShader(s),s}function bt(){if(!pt)return;const t=Mt?Ct:Ht;ft.blendFuncSeparate($t,t,Ct,t),ft.enable(Dt),ft.bufferSubData(_t,0,mt.subarray(0,pt*Ot*jt)),ft.drawArrays(Rt,0,pt*Ot),pt=0,Mt=yt}function At(t,n,s,e,i,o,r,h,c,u=4294967295,a=0){pt!=Et&&Mt==yt||bt();const l=Math.cos(i)/2,f=Math.sin(i)/2,d=l*s,w=l*e,g=f*s,m=f*e;let v=pt++*Ot*jt;mt[v++]=t-d-m,mt[v++]=n-w+g,mt[v++]=o,mt[v++]=c,vt[v++]=u,vt[v++]=a,mt[v++]=t+d+m,mt[v++]=n+w-g,mt[v++]=h,mt[v++]=r,vt[v++]=u,vt[v++]=a,mt[v++]=t-d+m,mt[v++]=n+w+g,mt[v++]=o,mt[v++]=r,vt[v++]=u,vt[v++]=a,mt[v++]=t-d-m,mt[v++]=n-w+g,mt[v++]=o,mt[v++]=c,vt[v++]=u,vt[v++]=a,mt[v++]=t+d-m,mt[v++]=n-w-g,mt[v++]=h,mt[v++]=c,vt[v++]=u,vt[v++]=a,mt[v++]=t+d+m,mt[v++]=n+w-g,mt[v++]=h,mt[v++]=r,vt[v++]=u,vt[v++]=a}const Ct=1,Rt=4,$t=770,Ht=771,Dt=3042,Ft=3553,Tt=5121,xt=5126,Pt=6408,Ut=9728,Wt=10240,Bt=10241,zt=10242,It=10243,Lt=16384,Nt=33071,_t=34962,qt=35048,Gt=35632,Jt=35633,Ot=6,jt=6,Et=65536,Yt=24,Kt=0,Qt=1,Vt=2,Xt=3,Zt=4,tn=5,nn=0,sn=1,en=2,on=3,rn=[[0,1],[1,0],[0,-1],[-1,0]],hn=0,cn=1,un=2,an=3,ln=4,fn=5;class dn{constructor(){this.buttons=[],this._=null}q(t){this.buttons.push(t)}G(t){const n=this.buttons.indexOf(t);n>-1&&this.buttons.splice(n,1)}pressed(){this._=null;for(let t=this.buttons.length-1;t>=0&&!this._;t--){const n=this.buttons[t];n.J()&&(this._=n)}return!!this._}O(){return!!this._&&(this._.J()&&this._.pressed(),this._=null,!0)}j(){this.buttons.forEach((t=>t.j()))}}class wn{constructor(t,n,s,e,i,o,r,h=!0){this.Y=t,this.size=n,this.text=s,this.K=e,this.bgColor=i,this.V=o,this.X=r||(()=>{}),this.Z=!0,this.visible=!0,this.tt=h}get enabled(){return this.Z}set enabled(t){this.Z=t,this.bgColor.a=t?1:.5,this.V.a=t?1:.5}J(){if(!this.enabled||!this.visible)return!1;const t=this.tt?K:Y;return t.x>=this.Y.x-this.size.x/2&&t.y>=this.Y.y-this.size.y/2&&t.x<this.Y.x+this.size.x/2&&t.y<this.Y.y+this.size.y/2}pressed(){this.X()}j(){if(!this.visible)return;let t,n;this.tt?(t=_,n=q):(t=N,n=G),t(this.Y,this.size,this.bgColor),n(this.text,this.Y,this.K,this.V)}}const gn=new class{constructor(){this.nt=null,this.st=hn}init(t){this.nt=t}et(t,n){this.st=t,this.it=this.nt[t],this.it.init(n)}ot(){this.it.ot()}rt(){this.it.rt()}},mn=new wn(a(0,-2),a(4,2.5),"Start",1.5,new f(1,1,1),new f(0,0,0),(()=>{gn.et(un)}),!1),vn=new dn;vn.q(mn);const pn={init(){},ot(){j(0)&&vn.pressed(),E(0)&&vn.O()},rt(){G("Death Estate",a(0,4),5,new f(1,0,0),c(1,1.2),new f(1,1,1)),vn.j()}},Mn=[null,null,new f(.6,.6,.6),new f(.5,.5,.5),new f(.8,.3,.3),new f(1,0,0)],yn=[new f(.3,.3,.3),new f(.35,.35,.35)];class Sn{constructor(t,n,s){this.x=n,this.y=s,this.type=t||0}t(){return new Sn(this.type,this.x,this.y)}apply(t){this.type=t.type}}class kn{constructor(t,n){this.Y=a(),this.ht=[],this.ct=[],this.ut=[],this.lt=!1,this.ft=!1,this.size=a(t,n);const s=this.size.x*this.size.y;for(let t=0;t<s;t+=1){const n=new Sn(0,t%this.size.x,Math.floor(t/this.size.y));this.ht.push(n),this.ut.push(n.t())}}dt(){this.ht.forEach(((t,n)=>this.ut[n].apply(t)))}wt(t){const n=t.gt(),s=this.gt();if(!(n[0].x>=s[0].x&&n[0].y>=s[0].y&&n[1].x<=s[1].x&&n[1].y<=s[1].y))return!1;const e=t.Y.o(a(2)),i=t.ht;for(let t=0;t<i.length;t+=1){const n=i[t];for(let s=0;s<n.length;s+=1){if(!n[s])continue;const i=e.add(a(s,t)),o=this.vt(i.x,i.y);if(o&&o.type)return!1}}return!0}Mt(t){const n=t.t();n.state=on;for(const t of this.ht){const s=a(t.x,t.y).multiply(a(2));n.Y=s;for(let t=0;t<4;t++){if(this.wt(n)&&this.yt(n))return n;n.rotate(1)}}return null}St(){const t=this.ht.filter((t=>t.type===Vt));for(const n of t)for(const t of rn){const s=a(n.x+t[0],n.y+t[1]),e=this.vt(s.x,s.y);if(e&&e.type===Kt)return void(this.ft=!0)}this.ft=!1}yt(t){const n=t.Y.o(a(2)),s=t.ht;for(let t=0;t<s.length;t+=1){const e=s[t];for(let s=0;s<e.length;s+=1){if(!e[s])continue;const i=n.add(a(s,t));if(rn.map((t=>this.vt(i.x+t[0],i.y+t[1]))).filter((t=>t)).some((t=>t.type===Vt)))return!0}}return!1}kt(t){t.state=sn,this.ct.push(t);const n=t.Y.o(a(2)),s=t.ht;for(let t=0;t<s.length;t+=1){const e=s[t];for(let s=0;s<e.length;s+=1){if(!e[s])continue;const i=n.add(a(s,t));this.bt(i.x,i.y,Qt)}}}At(){return this.size.multiply(a(2))}gt(){return[this.Y.t(),this.Y.add(this.size.multiply(a(2)))]}bt(t,n,s){this.ht[t+n*this.size.x].type=s}vt(t,n){return a(t,n).A(this.size)?this.ht[t+n*this.size.x]:null}Ct(){const t=this.Rt();return t?this.vt(t.x,t.y):null}Rt(t=!1){return this.$t(Y,t)}$t(t,n=!1){const s=t.i(this.Y).add(a(1));return n||s.A(this.size.multiply(a(2)))?s.o(a(2)).floor():null}Ht(t,n,s){const e=[];if(Math.abs(n.x-t.x)<Math.abs(n.y-t.y)){const s=Math.max(Math.min(n.y,t.y),0),i=Math.min(Math.max(n.y,t.y),this.size.y-1);for(let n=s;n<=i;n+=1)e.push(this.vt(t.x,n))}else{const s=Math.max(Math.min(n.x,t.x),0),i=Math.min(Math.max(n.x,t.x),this.size.x-1);for(let n=s;n<=i;n+=1)e.push(this.vt(n,t.y))}for(const t of e)t.type=s;return e}Dt(){this.ht.forEach(((t,n)=>t.apply(this.ut[n])))}Ft(){const t=this.ht.filter((t=>t.type===Vt||t.type===tn));t.forEach((t=>t.type=tn));const n=t.filter((t=>0===t.x||0===t.y||t.x===this.size.x-1||t.y===this.size.y-1));n.length?(n.forEach((t=>this.Tt(t.x,t.y))),this.lt=t.every((t=>t.type===Vt))):this.lt=!1}Tt(t,n){const s=this.vt(t,n);if(s&&s.type===tn){s.type=Vt;for(const s of rn)this.Tt(t+s[0],n+s[1])}}xt(){const t=this.size.x*this.size.y;let n=0,s=0;for(const t of this.ht)t.type===Qt?n+=1:t.type===Vt&&(s+=1);return{Pt:t,Ut:n,Wt:s}}j(){for(const t of this.ht){const n=a(t.x,t.y).multiply(a(2)).add(this.Y),s=Mn[t.type]||yn[(t.x+t.y)%2];s&&N(n,a(2),s)}for(const t of this.ct)t.j()}}const bn=[new f,new f(.9,.9,.9),new f(1,.3,.3),new f(1,1,1,.5)];class An{constructor(t,n){this.Y=t,this.ht=n||function(t){const n=2*t-1,s=u(1,n**2+1),e=[],i=[];for(let t=0;t<n;t++)e.push(new Array(n).fill(Kt));for(let t=0;t<s;t++){let s,o;if(0===t)s=u(0,n),o=u(0,n),i.push([s,o]);else{const t=i[u(0,i.length)],r=rn.map((s=>{let i=[t[0]+s[0],t[1]+s[1]];return i[0]<0||i[0]>=n||i[1]<0||i[1]>=n||e[i[1]][i[0]]!==Kt?null:i})).filter((t=>t));if(!r.length)continue;const h=r[u(0,r.length)];[s,o]=h,i.push(h)}e[o][s]=Qt}for(let t=e.length-1;t>=0;t--)e[t].every((t=>t===Kt))&&e.splice(t,1);for(let t=n-1;t>=0;t--)e.map((n=>n[t])).every((t=>t===Kt))&&e.forEach((n=>n.splice(t,1)));return e}(2),this.state=nn}t(){const t=[];for(let n=0;n<this.ht.length;n++)t.push([...this.ht[n]]);return new An(this.Y.t(),t)}gt(){const t=2*this.ht[0].length,n=2*this.ht.length;return[this.Y.t(),this.Y.add(a(t,n))]}Bt(){const t=Y.i(this.Y).add(a(1)).o(a(2)).floor(),n=this.ht[t.y];return!!n&&!!n[t.x]}rotate(t){const n=this.ht.length,s=this.ht[0].length,e=new Array(s);for(let t=0;t<s;t++)e[t]=new Array(n).fill(Kt);for(let t=0;t<n;t++)for(let n=0;n<s;n++)e[n][t]=this.ht[t][n];1===t?e.reverse():e.forEach((t=>t.reverse())),this.ht=e}j(){for(let t=0;t<this.ht.length;t+=1){const n=this.ht[t];for(let s=0;s<n.length;s+=1){if(!n[s])continue;const e=bn[this.state]||new f(1,0,0);N(a(s,t).multiply(a(2)).add(this.Y),a(2),e)}}}}let Cn,Rn,$n,Hn,Dn,Fn=a(),Tn=null,xn=null,Pn=a(),Un=null;const Wn=a(),Bn=a();let zn=a();const In=new dn,Ln=new wn(a(0,-4),a(5,3),"Done",1.5,new f(1,1,1),new f(0,0,0),(()=>{Cn.lt&&gn.et(an)}),!1);In.q(Ln);const Nn=new dn,_n=new wn(a(0,-5),a(5,3),"Rotate",1.2,new f(1,1,1),new f(0,0,0),(()=>{Dn.rotate(1)}),!1);Nn.q(_n);const qn=new wn(_n.Y.add(a(0,-4)),a(5,3),"Skip",1.5,new f(1,1,1),new f(0,0,0),(()=>{$n>0&&($n-=1,jn()),$n<=0&&(qn.enabled=!1)}),!1);Nn.q(qn);const Gn={lower:a(),upper:a()},Jn=qn.Y.i(qn.size.o(a(2))).add(a(1)),On=_n.Y.add(_n.size.o(a(2))).add(a(1));function jn(){Dn=new An(Pn.t()),Un=Cn.Mt(Dn)}const En={init(){Cn=new kn(15,15),Tn=null,xn=null;const t=Cn.At();v.x=Cn.Y.x+t.x/2-1,v.y=Cn.Y.y+t.y/2-1,Ln.Y.x=Cn.Y.x+t.x/2-1,Ln.enabled=!1,Wn.x=Ln.Y.x,Wn.y=Cn.Y.y+t.y-1+5,Bn.x=Ln.Y.x,Bn.y=Ln.Y.y-4},ot(){if(j(0)&&!In.pressed()&&(xn=Cn.Rt(),xn)){Cn.dt();const t=Cn.Ct();Rn=t.type===Vt||t.type===tn?Zt:Xt}if(E(0)){if(In.O(),xn){Cn.Dt();const t=Cn.Rt(!0);Rn===Xt?Cn.Ht(xn,t,Vt):Cn.Ht(xn,t,Kt),Cn.Ft(),Ln.enabled=Cn.lt}xn=null}if(O(0)&&xn){Cn.Dt();const t=Cn.Rt(!0);Cn.Ht(xn,t,Rn)}},rt(){Cn.j(),G("Make roads by clicking and dragging lines\non the grid. Delete by clicking and dragging\non existing roads",Wn,1.5),Cn.lt||G("All roads must connect to an edge of the grid",Bn,1.5),In.j()}},Yn={init(){const t=Cn.At();Pn.x=Cn.Y.x+t.x/2-1,Pn.y=-8,$n=3,qn.enabled=!0;const n=Cn.gt();Gn.lower=n[0].i(a(8)),Gn.upper=n[1].add(a(8)),Cn.St(),jn()},ot(){if(E(2)&&Dn.rotate(1),j(0)&&!Nn.pressed()&&Dn.Bt()&&(Dn.state=nn,Fn=Dn.Y.t(),Tn=Y.t()),E(0)&&(Nn.O(),Tn)){Dn.Y.x=2*Math.floor((Dn.Y.x+1)/2),Dn.Y.y=2*Math.floor((Dn.Y.y+1)/2);const t=Dn.gt(),n=a((t[0].x+t[1].x)/2,(t[0].y+t[1].y)/2);n.x>=Jn.x&&n.x<=On.x&&n.y>=Jn.y&&n.y<=On.y&&(Dn.Y.x=Fn.x,Dn.Y.y=Fn.y),Cn.wt(Dn)&&Cn.yt(Dn)?(Cn.kt(Dn),Cn.St(),jn()):Dn.state=en,Tn=null}if(O(0)&&Tn){Dn.Y.x=Fn.x+(Y.x-Tn.x),Dn.Y.y=Fn.y+(Y.y-Tn.y);const t=Dn.gt();t[0].x<Gn.lower.x?Dn.Y.x=Gn.lower.x:t[1].x>Gn.upper.x&&(Dn.Y.x=Gn.upper.x-(t[1].x-t[0].x)),t[0].y<Gn.lower.y?Dn.Y.y=Gn.lower.y:t[1].y>Gn.upper.y&&(Dn.Y.y=Gn.upper.y-(t[1].y-t[0].y))}(!Cn.ft||!Un&&$n<=0)&&gn.et(ln)},rt(){Cn.j(),Dn.j(),G("Place houses! Must touch a road, not overlap\nother houses, and be within the grid",Wn,1.5),G("right-click\nworks too",_n.Y.add(a(3,.5)),1,void 0,void 0,void 0,"left"),G(`Skips left: ${$n}`,qn.Y.add(a(3,0)),1.5,void 0,void 0,void 0,"left"),Nn.j()}},Kn={init(){_n.enabled=!1,qn.enabled=!1,Hn=Date.now()},ot(){const n=Date.now(),s=n-Hn;if(zn=((n=1)=>(new l).p(c(2*t),n))(h(r(s,0,1e3),1,0)),s>=3e3){const t=Cn.xt();gn.et(fn,{timestamp:n,zt:t.Pt,It:t.Ut,Wt:t.Wt})}},rt(){Cn.j(),Dn.j(),G("Game over! No more space or skips",Wn.add(zn),1.5),G("right-click\nworks too",_n.Y.add(a(3,.5)),1,new f(1,1,1,.5),void 0,void 0,"left"),G(`Skips left: ${$n}`,qn.Y.add(a(3,0)),1.5,new f(1,1,1,.5),void 0,void 0,"left"),Nn.j()}},Qn=new f(1,0,0),Vn=new f(1,1,1),Xn=new f(1,1,1),Zn=new f(1,1,0),ts="deathestate_jayther_ldb",ns={};let ss,es=[],is=0,os=0,rs=!0;const hs=a(0,18),cs=hs.add(a(0,-5)),us=hs.add(a(0,-13)),as=us.add(a(3,-5)),ls=new Array(5);for(let t=0;t<ls.length;t++)ls[t]=[as.add(a(-.7,-2*t)),as.add(a(.7,-2*t))];const fs=new dn,ds=new wn(hs.add(a(0,-31)),a(5,3),"Retry",1.5,new f(1,1,1),new f(0,0,0),(()=>{gn.et(un)}),!1);function ws(t,n){for(ss={It:t,timestamp:n,Lt:new Date(n).toLocaleDateString(),Nt:!0},es.push(ss),es.sort(((t,n)=>{const s=n.It-t.It;return 0===s?n.timestamp-t.timestamp:s}));es.length>5;)es.pop();!function(){const t=es.map((t=>({It:t.It,timestamp:t.timestamp}))),n=JSON.stringify(t);if(rs)try{window.localStorage.setItem(ts,n)}catch(t){rs=!1}rs||(ns[ts]=n)}()}fs.q(ds);const gs=[{init(){},ot(){},rt(){}},pn,En,Yn,Kn,{init(t){is=t.zt,os=t.Wt,function(){let t=null;if(rs)try{t=window.localStorage.getItem(ts)}catch(t){rs=!1}else t=ns[ts]||null;t&&(es=JSON.parse(t)),es.forEach((t=>t.Lt=new Date(t.timestamp).toLocaleDateString()))}(),ws(t.It,t.timestamp),v.x=0,v.y=0},ot(){j(0)&&fs.pressed(),E(0)&&fs.O()},rt(){!function(){G("Game over",hs,4,Qn,.5,Vn),G(`You covered ${ss.It} tiles (${Math.floor(ss.It/is*100)}%)\n(road count: ${os}, grid total: ${is})`,cs,2,Xn),G("High Scores",us,4,Qn,.5,Vn);for(let t=0;t<5;t++){const n=es[t];let s,e,i;n?(s=n.Lt,e=n.It.toString(),i=n.Nt?Zn:Xn):(s="-------------",e="---",i=Xn),G(s,ls[t][0],2,i,void 0,void 0,"right"),G(e,ls[t][1],2,i,void 0,void 0,"left")}}(),fs.j()}}],ms=680,vs=940,ps=p;!function(t,n,e,i,o,r){T.onerror=T.onload=()=>{S=a(m).o(y=a(T.width,T.height)),document.body.style="margin:0;overflow:hidden;background:#000;touch-action:none;user-select:none;-webkit-user-select:none;-moz-user-select:none",document.body.appendChild(x=document.createElement("canvas")),P=x.getContext("2d"),x.style=D,function(){0;lt=document.createElement("canvas"),ft=lt.getContext("webgl",{antialias:!1}),lt.style=D,dt=function(t){if(!t||!t.width)return;const n=ft.createTexture();return ft.bindTexture(Ft,n),ft.texImage2D(Ft,0,Pt,Pt,Tt,t),ft.texParameteri(Ft,Bt,Ut),ft.texParameteri(Ft,Wt,Ut),ft.texParameteri(Ft,zt,Nt),ft.texParameteri(Ft,It,Nt),n}(T),document.body.appendChild(lt),gt=function(t,n){0;const s=ft.createProgram();ft.attachShader(s,kt(t,Jt)),ft.attachShader(s,kt(n,Gt)),ft.linkProgram(s),0;return s}("precision highp float;uniform mat4 m;attribute vec2 p,t;attribute vec4 c,a;varying vec2 v;varying vec4 d,e;void main(){gl_Position=m*vec4(p,1,1);v=t;d=c;e=a;}","precision highp float;varying vec2 v;varying vec4 d,e;uniform sampler2D s;void main(){gl_FragColor=texture2D(s,v)*d+e;}");const t=new ArrayBuffer(Et*Ot*Yt);(function(t,n,s){0;const e=ft.createBuffer();ft.bindBuffer(t,e),ft.bufferData(t,n,s)})(_t,t.byteLength,qt),mt=new Float32Array(t),vt=new Uint32Array(t);let n=pt=0;const s=(t,s,e,i,o=0)=>{const r=ft.getAttribLocation(gt,t);ft.enableVertexAttribArray(r),ft.vertexAttribPointer(r,i,s,o,Yt,n),n+=i*e};s("p",xt,4,2),s("t",xt,4,2),s("c",Tt,1,4,1),s("a",Tt,1,4,1)}(),document.body.appendChild(U=document.createElement("canvas")),W=U.getContext("2d"),U.style=D,t(),h()};const h=(t=0)=>{let r=t-$;if($=t,R+=r/1e3,H=s(H+!0*r,50),w.x){U.width=x.width=w.x,U.height=x.height=w.y;const t=innerWidth/innerHeight,n=x.width/x.height;x.style.width=U.style.width=t<n?"100%":"",x.style.height=U.style.height=t<n?"":"100%",lt&&(lt.style.width=x.style.width,lt.style.height=x.style.height)}else U.width=x.width=s(innerWidth,d.x),U.height=x.height=s(innerHeight,d.y);B=a(x.width,x.height);{let t=0;for(H<0&&H>-9&&(t=H,H=0);H>=0;H-=1e3/60)tt(),n(),F(),e(),nt();H+=t}B=a(x.width,x.height),P.imageSmoothingEnabled=!1,function(t,n,s,e,i){var o;ft.viewport(0,0,lt.width=t,lt.height=n),ft.clear(Lt),ft.bindTexture(Ft,wt=dt),ft.useProgram(gt),yt=o;const r=2*i/t,h=2*i/n;ft.uniformMatrix4fv(ft.getUniformLocation(gt,"m"),0,new Float32Array([r,0,0,0,0,h,0,0,1,1,-1,1,-1-r*s,-1-h*e,0,0]))}(x.width,x.height,v.x,v.y,p),i(),k.sort(((t,n)=>t._t-n._t));for(const t of k)t.W||t.j();o(),function(){if(!St.length)return;const t=St[0],n=R-at;if(at)if(n>5)St.shift(at=0);else{const s=4.5,e=n<M?1-n/M:n>s?(n-s)/M:0;t.j(e)}else at=R}(),function(t,n){if(!pt&&!n)return;bt(),n&&t.drawImage(lt,0,0)}(P),requestAnimationFrame(h)};r?T.src=r:T.onload()}((function(){ys(),gn.init(gs),gn.et(cn)}),(function(){gn.ot()}),(function(){}),(function(){gn.rt()}),(function(){}));let Ms=null;function ys(){const t=ms/vs>innerWidth/innerHeight?innerWidth/ms:innerHeight/vs;!function(t){p=t}(ps*t)}window.addEventListener("resize",(function(){clearTimeout(Ms),Ms=setTimeout(ys,200)}),!1)}();
      </script>
  </body>
</html>
