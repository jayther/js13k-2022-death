<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Death Estate</title>
      <style>
        a,abbr,acronym,address,applet,article,aside,audio,b,big,blockquote,body,canvas,caption,center,cite,code,dd,del,details,dfn,div,dl,dt,em,embed,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,html,i,iframe,img,ins,kbd,label,legend,li,mark,menu,nav,object,ol,output,p,pre,q,ruby,s,samp,section,small,span,strike,strong,sub,summary,sup,table,tbody,td,tfoot,th,thead,time,tr,tt,u,ul,var,video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:after,blockquote:before,q:after,q:before{content:'';content:none}table{border-collapse:collapse;border-spacing:0}
      </style>
  </head>
  <body>
      <script>
        !function(){"use strict";const t=Math.PI,s=t=>t<0?-t:t,i=(t,s)=>t<s?t:s,n=(t,s)=>t>s?t:s,e=t=>t<0?-1:1,o=(t,s=0,i=1)=>t<s?s:t>i?i:t,h=(t,s=0,i=1)=>i-s?o((t-s)/(i-s)):0,r=(t,s=0,i=1)=>s+o(t)*(i-s),c=(t=1,s=0)=>s+(t-s)*Math.random(),u=(t=1,s=0)=>0|c(t,s),l=(t=0,s)=>null==t.x?new a(t,null==s?t:s):new a(t.x,t.y);class a{constructor(t=0,s=0){this.x=t,this.y=s}t(){return new a(this.x,this.y)}add(t){return new a(this.x+t.x,this.y+t.y)}i(t){return new a(this.x-t.x,this.y-t.y)}multiply(t){return new a(this.x*t.x,this.y*t.y)}o(t){return new a(this.x/t.x,this.y/t.y)}scale(t){return new a(this.x*t,this.y*t)}length(){return this.h()**.5}h(){return this.x**2+this.y**2}u(t){return this.l(t)**.5}l(t){return(this.x-t.x)**2+(this.y-t.y)**2}normalize(t=1){const s=this.length();return s?this.scale(t/s):new a(0,t)}g(t=1){const s=this.length();return s>t?this.scale(t/s):this}m(t){return this.x*t.x+this.y*t.y}v(t){return this.x*t.y-this.y*t.x}angle(){return Math.atan2(this.x,this.y)}p(t=0,s=1){return this.x=s*Math.sin(t),this.y=s*Math.cos(t),this}rotate(t){const s=Math.cos(t),i=Math.sin(t);return new a(this.x*s-this.y*i,this.x*i+this.y*s)}direction(){return s(this.x)>s(this.y)?this.x<0?3:1:this.y<0?2:0}M(){return new a(this.y,-this.x)}floor(){return new a(Math.floor(this.x),Math.floor(this.y))}S(){return s(this.x*this.y)}k(t,s){return this.add(t.i(this).scale(o(s)))}A(t){return this.x>=0&&this.y>=0&&this.x<t.x&&this.y<t.y}toString(t=3){return`(${(this.x<0?"":" ")+this.x.toFixed(t)},${(this.y<0?"":" ")+this.y.toFixed(t)} )`}}class f{constructor(t=1,s=1,i=1,n=1){this.r=t,this.C=s,this.b=i,this.a=n}t(){return new f(this.r,this.C,this.b,this.a)}add(t){return new f(this.r+t.r,this.C+t.C,this.b+t.b,this.a+t.a)}i(t){return new f(this.r-t.r,this.C-t.C,this.b-t.b,this.a-t.a)}multiply(t){return new f(this.r*t.r,this.C*t.C,this.b*t.b,this.a*t.a)}o(t){return new f(this.r/t.r,this.C/t.C,this.b/t.b,this.a/t.a)}scale(t,s=t){return new f(this.r*t,this.C*t,this.b*t,this.a*s)}R(){return new f(o(this.r),o(this.C),o(this.b),o(this.a))}k(t,s){return this.add(t.i(this).scale(o(s)))}$(t=0,s=0,i=1,n=1){const e=i<.5?i*(1+s):i+s-i*s,o=2*i-e,h=(t,s,i)=>(i=(i%1+1)%1)<1/6?t+6*(s-t)*i:i<.5?s:i<2/3?t+(s-t)*(2/3-i)*6:t;return this.r=h(o,e,t+1/3),this.C=h(o,e,t),this.b=h(o,e,t-1/3),this.a=n,this}T(){const t=this.r,s=this.C,i=this.b,n=this.a,e=Math.max(t,s,i),o=Math.min(t,s,i),h=(e+o)/2;let r=0,c=0;if(e!=o){let n=e-o;c=h>.5?n/(2-e-o):n/(e+o),t==e?r=(s-i)/n+(s<i?6:0):s==e?r=(i-t)/n+2:i==e&&(r=(t-s)/n+4)}return[r/6,c,h,n]}D(t=.05,s=0){return new f(this.r+c(t,-t),this.C+c(t,-t),this.b+c(t,-t),this.a+c(s,-s)).R()}toString(){return`rgb(${255*this.r|0},${255*this.C|0},${255*this.b|0},${this.a})`}P(){return(255*this.r|0)+(255*this.C<<8)+(255*this.b<<16)+(255*this.a<<24)}F(t){const s=s=>parseInt(t.slice(s,s+2),16)/255;return this.r=s(1),this.C=s(3),this.b=s(5),this.a=1,this}H(){const t=t=>((t=255*t|0)<16?"0":"")+t.toString(16);return"#"+t(this.r)+t(this.C)+t(this.b)}}let d=l(1920,1200),w=l(),g=l(16),m=.3,v=(l(1),l()),p=n(g.x,g.y);let M=.5;let y,S,k=[],x=[],b=0,A=0,C=0,R=0,$=0;const T="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)";function D(){x=k.filter((t=>t.W));const t=s=>{if(!s.U){s.update();for(const i of s.children)t(i)}};for(const s of k)s.parent||t(s);k=k.filter((t=>!t.U)),A=++b/60}const P=new Image;let F,H,W,U,N=l();const z=t=>t.add(l(.5)).i(N.scale(.5)).multiply(l(1/p,-1/p)).add(v),B=t=>t.i(v).multiply(l(p,-p)).add(N.scale(.5)).i(l(.5));function E(t,s=l(1),i=-1,n=g,e=new f,o=0,h,r=new f(0,0,0,0),c=1){if(c)if(i<0||!P.width)bt(t.x,t.y,s.x,s.y,o,0,0,0,0,0,e.P());else{const c=y.x/n.x|0,u=n.x/y.x,l=n.y/y.y,a=i%c*u,f=(i/c|0)*l;bt(t.x,t.y,h?-s.x:s.x,s.y,o,a+S.x,f+S.y,a-S.x+u,f-S.y+l,e.P(),r.P())}else!function(t,s,i,n,e,o=H){t=B(t),s=s.scale(p),o.save(),o.translate(t.x+.5|0,t.y-.5|0),o.rotate(i),o.scale(n?-s.x:s.x,s.y),e(o),o.restore()}(t,s,o,h,(t=>{if(i<0)t.fillStyle=e,t.fillRect(-.5,-.5,1,1);else{const s=y.x/n.x|0,o=i%s*n.x+m,h=(i/s|0)*n.y+m,r=n.x-.6,c=n.y-.6;t.globalAlpha=e.a,t.drawImage(P,o,h,r,c,-.5,-.5,1,1)}}))}function I(t,s,i,n,e){E(t,s,-1,g,i,n,0,0,e)}function L(t,s,i,n,e){!function(t,s=l(1),i,n,e,o,h,r,c){E(z(t),s.scale(1/p),i,n,e,o,h,r,c)}(t,s,-1,g,i,n,0,0,e)}function _(t,s,i=1,n=new f,e=0,o=new f(0,0,0),h="center",r="arial"){U.fillStyle=n,U.lineWidth=e,U.strokeStyle=o,U.textAlign=h,U.font=i+"px "+r,U.textBaseline="middle",U.lineJoin="round",s=s.t(),(t+"").split("\n").forEach((t=>{e&&U.strokeText(t,s.x,s.y),U.fillText(t,s.x,s.y),s.y+=i}))}function q(t,s,i=1,n,e,o,h,r){_(t,B(s),i*p,n,e*p,o,h,r)}const G=(t,s=0)=>Z[s]&&1&Z[s][t]?1:0,J=G,O=(t,s=0)=>Z[s]&&2&Z[s][t]?1:0,j=(t,s=0)=>Z[s]&&4&Z[s][t]?1:0;let Y=l(),K=l(),Q=0,V=0;const X=(t,s=0)=>G(t,s+1);let Z=[[]];function tt(){document.hasFocus()||(Z=[[]]),Y=z(K),function(){0;if(!navigator.getGamepads||!document.hasFocus())return;const t=navigator.getGamepads();for(let s=t.length;s--;){const i=t[s],n=Z[s+1]||(Z[s+1]=[]),e=et[s]||(et[s]=[]);if(i){const t=.3,o=.8,r=s=>s>t?h(s,t,o):s<-t?-h(-s,t,o):0;for(let t=0;t<i.axes.length-1;t+=2)e[t>>1]=l(r(i.axes[t]),r(-i.axes[t+1])).g();for(let t=i.buttons.length;t--;){const e=i.buttons[t];n[t]=e.pressed?1+2*!X(t,s):4*X(t,s),V|=!s&&e.pressed}{const t=l(X(15,s)-X(14,s),X(12,s)-X(13,s));t.h()&&(e[0]=t.g())}}}}()}function st(){for(const t of Z)for(const s in t)t[s]&=1;Q=0}onkeydown=t=>{t.repeat||(Z[V=0][it(t.keyCode)]=3)},onkeyup=t=>{Z[0][it(t.keyCode)]=4};const it=t=>87==t?38:83==t?40:65==t?37:68==t?39:t;onmousedown=t=>{Z[V=0][t.button]=3,onmousemove(t),t.button&&t.preventDefault()},onmouseup=t=>Z[0][t.button]=2&Z[0][t.button]|4,onmousemove=t=>K=nt(t),onwheel=t=>t.ctrlKey||(Q=e(t.deltaY)),oncontextmenu=t=>!1;const nt=t=>{if(!F)return l();const s=F.getBoundingClientRect();return l(F.width,F.height).multiply(l(h(t.x,s.left,s.right),h(t.y,s.top,s.bottom)))},et=[];const ot=void 0!==window.ontouchstart;if(ot){let t,s;ontouchstart=ontouchmove=ontouchend=i=>{i.button=0;const n=i.touches.length;return n?(s||rt(0,s=1),i.x=i.touches[0].clientX,i.y=i.touches[0].clientY,t?onmousemove(i):onmousedown(i)):t&&onmouseup(i),t=n,!i.cancelable}}let ht;new class{constructor(t){this.time=null==t?void 0:A+t,this.setTime=t}set(t=0){this.time=A+t,this.setTime=t}N(){this.time=void 0}B(){return null!=this.time}active(){return A<=this.time}I(){return A>this.time}get(){return this.B()?A-this.time:0}L(){return this.B()?h(this.time-A,this.setTime,0):0}toString(){0}},l();const rt=(...t)=>function(t,s=1,i=1,n=0,e=0){if(ht||(ht=new(window.AudioContext||webkitAudioContext)),ht.resume(),"running"!=ht.state)return;const h=ht.createBuffer(t.length,t[0].length,ct),r=ht.createBufferSource();t.forEach(((t,s)=>h.getChannelData(s).set(t))),r.buffer=h,r.playbackRate.value=i,r.loop=e;const c=ht.createGain();return c.gain.value=.5*s,c.connect(ht.destination),(window.StereoPannerNode?r.connect(new StereoPannerNode(ht,{pan:o(n,-1,1)})):r).connect(c),r.start(),r}([ut(...t)]),ct=44100;function ut(o=1,h=.05,r=220,u=0,l=0,a=.1,f=0,d=1,w=0,g=0,m=0,v=0,p=0,M=0,y=0,S=0,k=0,x=1,b=0,A=0){let C,R,$=2*t,T=w*=500*$/ct/ct,D=[],P=r*=(1+h*c(-1,1))*$/ct,F=0,H=0,W=0,U=1,N=0,z=0,B=0;for(g*=500*$/ct**3,y*=$/ct,m*=$/ct,v*=ct,p=p*ct|0,R=(u=u*ct+9)+(b*=ct)+(l*=ct)+(a*=ct)+(k*=ct)|0;W<R;D[W++]=B)++z%(100*S|0)||(B=f?f>1?f>2?f>3?Math.sin((F%$)**3):n(i(Math.tan(F),1),-1):1-(2*F/$%2+2)%2:1-4*s(Math.round(F/$)-F/$):Math.sin(F),B=(p?1-A+A*Math.sin($*W/p):1)*e(B)*s(B)**d*o*.5*(W<u?W/u:W<u+b?1-(W-u)/b*(1-x):W<u+b+l?x:W<R-k?(R-W-k)/a*x:0),B=k?B/2+(k>W?0:(W<R-k?1:(R-W)/k)*D[W-k|0]/2):B),C=(r+=w+=g)*Math.cos(y*H++),F+=C-C*M*(1-1e9*(Math.sin(W)+1)%2),U&&++U>v&&(r+=m,P+=m,U=0),!p||++N%p||(r=P,w=T,U=U||1);return D}l();let lt,at,ft,dt,wt,gt,mt,vt,pt,Mt,yt,St=[];function kt(t,s){const i=ft.createShader(s);return ft.shaderSource(i,t),ft.compileShader(i),i}function xt(){if(!pt)return;const t=Mt?At:$t;ft.blendFuncSeparate(Rt,t,At,t),ft.enable(Tt),ft.bufferSubData(Lt,0,mt.subarray(0,pt*Jt*Ot)),ft.drawArrays(Ct,0,pt*Jt),pt=0,Mt=yt}function bt(t,s,i,n,e,o,h,r,c,u=4294967295,l=0){pt!=jt&&Mt==yt||xt();const a=Math.cos(e)/2,f=Math.sin(e)/2,d=a*i,w=a*n,g=f*i,m=f*n;let v=pt++*Jt*Ot;mt[v++]=t-d-m,mt[v++]=s-w+g,mt[v++]=o,mt[v++]=c,vt[v++]=u,vt[v++]=l,mt[v++]=t+d+m,mt[v++]=s+w-g,mt[v++]=r,mt[v++]=h,vt[v++]=u,vt[v++]=l,mt[v++]=t-d+m,mt[v++]=s+w+g,mt[v++]=o,mt[v++]=h,vt[v++]=u,vt[v++]=l,mt[v++]=t-d-m,mt[v++]=s-w+g,mt[v++]=o,mt[v++]=c,vt[v++]=u,vt[v++]=l,mt[v++]=t+d-m,mt[v++]=s-w-g,mt[v++]=r,mt[v++]=c,vt[v++]=u,vt[v++]=l,mt[v++]=t+d+m,mt[v++]=s+w-g,mt[v++]=r,mt[v++]=h,vt[v++]=u,vt[v++]=l}const At=1,Ct=4,Rt=770,$t=771,Tt=3042,Dt=3553,Pt=5121,Ft=5126,Ht=6408,Wt=9728,Ut=10240,Nt=10241,zt=10242,Bt=10243,Et=16384,It=33071,Lt=34962,_t=35048,qt=35632,Gt=35633,Jt=6,Ot=6,jt=65536,Yt=24,Kt=0,Qt=1,Vt=2,Xt=3,Zt=4,ts=5,ss=0,is=1,ns=2,es=3,os=[[0,1],[1,0],[0,-1],[-1,0]],hs=os.concat([[1,1],[1,-1],[-1,-1],[-1,1]]),rs=0,cs=1,us=2,ls=3,as=4,fs=5,ds=6,ws={_:1,q:2,G:4,J:8,O:16,j:32,Y:64,K:128},gs=[ws._,ws.q,ws.G,ws.J,ws.O,ws.j,ws.Y,ws.K];class ms{constructor(){this.buttons=[],this.V=null}X(t){this.buttons.push(t)}Z(t){const s=this.buttons.indexOf(t);s>-1&&this.buttons.splice(s,1)}pressed(){this.V=null;for(let t=this.buttons.length-1;t>=0&&!this.V;t--){const s=this.buttons[t];s.tt()&&(this.V=s)}return!!this.V}st(){return!!this.V&&(this.V.tt()&&this.V.pressed(),this.V=null,!0)}it(){this.buttons.forEach((t=>t.it()))}}class vs{constructor(t,s,i,n,e,o,h,r=!0){this.nt=t,this.size=s,this.text=i,this.et=n,this.bgColor=e,this.ot=o,this.ht=h||(()=>{}),this.rt=!0,this.visible=!0,this.ct=r}get enabled(){return this.rt}set enabled(t){this.rt=t,this.bgColor.a=t?1:.5,this.ot.a=t?1:.5}tt(){if(!this.enabled||!this.visible)return!1;const t=this.ct?K:Y;return t.x>=this.nt.x-this.size.x/2&&t.y>=this.nt.y-this.size.y/2&&t.x<this.nt.x+this.size.x/2&&t.y<this.nt.y+this.size.y/2}pressed(){this.ht()}it(){if(!this.visible)return;let t,s;this.ct?(t=L,s=_):(t=I,s=q),t(this.nt,this.size,this.bgColor),s(this.text,this.nt,this.et,this.ot)}}const ps=new class{constructor(){this.ut=null,this.lt=rs}init(t){this.ut=t}ft(t,s){this.lt=t,this.dt=this.ut[t],this.dt.init(s)}wt(){this.dt.wt()}gt(){this.dt.gt()}},Ms=new vs(l(0,-2),l(4,2.5),"Start",1.5,new f(1,1,1),new f(0,0,0),(()=>{ps.ft(us)}),!1),ys=new ms;ys.X(Ms);const Ss={init(){},wt(){O(0)&&ys.pressed(),j(0)&&ys.st()},gt(){q("Death Estate",l(0,4),5,new f(1,0,0),c(1,1.2),new f(1,1,1)),ys.it()}},ks=[null,null,new f(.6,.6,.6),new f(.5,.5,.5),new f(.8,.3,.3),new f(1,0,0)],xs=[new f(.278,.176,.235),new f(.223,.125,.183)],bs=[null,{index:4,angle:t},{index:4,angle:-t/2},{index:1,angle:-t/2},{index:4,angle:0},{index:0,angle:0},{index:1,angle:0},{index:2,angle:0},{index:4,angle:t/2},{index:1,angle:t},{index:0,angle:t/2},{index:2,angle:-t/2},{index:1,angle:t/2},{index:2,angle:t},{index:2,angle:t/2},{index:3,angle:0}];class As{constructor(t,s,i){this.x=s,this.y=i,this.type=t||0,this.vt=0,this.Mt=!1}t(){return new As(this.type,this.x,this.y)}apply(t){this.type=t.type}}class Cs{constructor(t,s){this.nt=l(),this.yt=[],this.St=[],this.kt=[],this.xt=!1,this.bt=!1,this.size=l(t,s);const i=this.size.x*this.size.y;for(let t=0;t<i;t+=1){const s=new As(0,t%this.size.x,Math.floor(t/this.size.y));this.yt.push(s),this.kt.push(s.t())}}At(){this.yt.forEach(((t,s)=>this.kt[s].apply(t)))}Ct(t){const s=t.Rt(),i=this.Rt();if(!(s[0].x>=i[0].x&&s[0].y>=i[0].y&&s[1].x<=i[1].x&&s[1].y<=i[1].y))return!1;const n=t.nt.o(l(2)),e=t.yt;for(let t=0;t<e.length;t+=1){const s=e[t];for(let i=0;i<s.length;i+=1){if(!(7&s[i]))continue;const e=n.add(l(i,t)),o=this.$t(e.x,e.y);if(o&&o.type)return!1}}return!0}Tt(t){const s=t.t();s.state=es;for(const t of this.yt){const i=l(t.x,t.y).multiply(l(2));s.nt=i;for(let t=0;t<4;t++){if(this.Ct(s)&&this.Dt(s))return s;s.rotate(1)}}return null}Pt(){const t=this.yt.filter((t=>t.type===Vt));for(const s of t)for(const t of os){const i=l(s.x+t[0],s.y+t[1]),n=this.$t(i.x,i.y);if(n&&n.type===Kt)return void(this.bt=!0)}this.bt=!1}Dt(t){const s=t.nt.o(l(2)),i=t.yt;for(let t=0;t<i.length;t+=1){const n=i[t];for(let i=0;i<n.length;i+=1){if(!(7&n[i]))continue;const e=s.add(l(i,t));if(os.map((t=>this.$t(e.x+t[0],e.y+t[1]))).filter((t=>t)).some((t=>t.type===Vt)))return!0}}return!1}Ft(t){t.state=is,this.St.push(t);const s=t.nt.o(l(2)),i=t.yt;for(let t=0;t<i.length;t+=1){const n=i[t];for(let i=0;i<n.length;i+=1){if(!(7&n[i]))continue;const e=s.add(l(i,t));this.Ht(e.x,e.y,Qt)}}}Wt(){return this.size.multiply(l(2))}Rt(){return[this.nt.t(),this.nt.add(this.size.multiply(l(2)))]}Ht(t,s,i){this.yt[t+s*this.size.x].type=i}$t(t,s){return l(t,s).A(this.size)?this.yt[t+s*this.size.x]:null}Ut(){const t=this.Nt();return t?this.$t(t.x,t.y):null}Nt(t=!1){return this.zt(Y,t)}zt(t,s=!1){const i=t.i(this.nt).add(l(1));return s||i.A(this.size.multiply(l(2)))?i.o(l(2)).floor():null}Bt(t,s,i){const n=[];if(Math.abs(s.x-t.x)<Math.abs(s.y-t.y)){const i=Math.max(Math.min(s.y,t.y),0),e=Math.min(Math.max(s.y,t.y),this.size.y-1);for(let s=i;s<=e;s+=1)n.push(this.$t(t.x,s))}else{const i=Math.max(Math.min(s.x,t.x),0),e=Math.min(Math.max(s.x,t.x),this.size.x-1);for(let s=i;s<=e;s+=1)n.push(this.$t(s,t.y))}for(const t of n)t.type=i;return n}Et(){this.yt.forEach(((t,s)=>t.apply(this.kt[s])))}It(){const t=this.yt.filter((t=>t.type===Vt||t.type===ts));t.forEach((t=>{t.type=ts,t.Mt=!1}));const i=t.filter((t=>0===t.x||0===t.y||t.x===this.size.x-1||t.y===this.size.y-1));if(!i.length)return void(this.xt=!1);const n=[];i.forEach((t=>{n.some((i=>s(i.x-t.x)<=3&&s(i.y-t.y)<=3))&&t.type!==ts||(t.Mt=!0,n.push(t)),this.Lt(t.x,t.y)})),this.xt=t.every((t=>t.type===Vt))}Lt(t,s){const i=this.$t(t,s);if(i&&i.type===ts){i.type=Vt;for(const i of os)this.Lt(t+i[0],s+i[1])}}_t(){const t=this.yt.filter((t=>t.type===Vt));for(const s of t)s.vt=os.reduce(((t,i,n)=>{const e=l(s.x+i[0],s.y+i[1]);if(e.A(this.size)){const s=this.$t(e.x,e.y);if(!s||s.type!==Vt)return t}else if(!s.Mt)return t;return t|gs[n]}),0)}qt(){const t=this.size.x*this.size.y;let s=0,i=0;for(const t of this.yt)t.type===Qt?s+=1:t.type===Vt&&(i+=1);return{Gt:t,Jt:s,Ot:i}}it(){for(const t of this.yt){let s=-1,i=0;const n=l(t.x,t.y).multiply(l(2)).add(this.nt),e=ks[t.type]||xs[(t.x+t.y)%2];if(t.type===Vt){const n=bs[t.vt];n&&(s=n.index+16,i=n.angle)}s>-1?E(n,l(2),s,void 0,void 0,i):e&&I(n,l(2),e)}for(const t of this.St)t.it()}}const Rs=[new f(1,1,1,.3),null,new f(1,0,0,.5),new f(1,1,1,.5)],$s=l(2);class Ts{constructor(t,s){this.nt=t,this.yt=s||function(t){const s=2*t-1,i=u(1,s**2+1),n=[],e=[];for(let t=0;t<s;t++)n.push(new Array(s).fill(Kt));for(let t=0;t<i;t++){let i,o;if(0===t)i=u(0,s),o=u(0,s),e.push([i,o]);else{const t=e[u(0,e.length)],h=os.map((i=>{let e=[t[0]+i[0],t[1]+i[1]];return e[0]<0||e[0]>=s||e[1]<0||e[1]>=s||n[e[1]][e[0]]!==Kt?null:e})).filter((t=>t));if(!h.length)continue;const r=h[u(0,h.length)];[i,o]=r,e.push(r)}n[o][i]=Qt}for(let t=n.length-1;t>=0;t--)n[t].every((t=>t===Kt))&&n.splice(t,1);for(let t=s-1;t>=0;t--)n.map((s=>s[t])).every((t=>t===Kt))&&n.forEach((s=>s.splice(t,1)));return n}(2),this._t(),this.state=ss}_t(){for(let t=0;t<this.yt.length;t++)for(let s=0;s<this.yt[t].length;s++){const i=l(this.yt[t].length,this.yt.length),n=hs.reduce(((n,e,o)=>{const h=l(s+e[0],t+e[1]);return h.A(i)&&7&this.yt[h.y][h.x]?n|gs[o]:n}),0);this.yt[t][s]=7&this.yt[t][s]|n<<3}}t(){const t=[];for(let s=0;s<this.yt.length;s++)t.push([...this.yt[s]]);return new Ts(this.nt.t(),t)}Rt(){const t=2*this.yt[0].length,s=2*this.yt.length;return[this.nt.t(),this.nt.add(l(t,s))]}jt(){const t=Y.i(this.nt).add(l(1)).o(l(2)).floor(),s=this.yt[t.y];return!!s&&!!s[t.x]}rotate(t){const s=this.yt.length,i=this.yt[0].length,n=new Array(i);for(let t=0;t<i;t++)n[t]=new Array(s).fill(Kt);for(let t=0;t<s;t++)for(let s=0;s<i;s++)n[s][t]=this.yt[t][s];1===t?n.reverse():n.forEach((t=>t.reverse())),this.yt=n,this._t()}it(){for(let t=0;t<this.yt.length;t+=1){const s=this.yt[t];for(let i=0;i<s.length;i+=1){const n=s[i];if(!(7&n))continue;const e=Rs[this.state],o=l(i,t).multiply($s).add(this.nt);E(o,$s,n>>3&15),e&&I(o,$s,e)}}}}class Ds{constructor(t){this.nt=t,this.color=new f(1,1,1,1),this.size=l(6),this.Yt=!1,this.Kt=t.t(),this.Qt=l(),this.Vt=0,this.Xt=0,this.Zt=null,this.ts=!1,this.ss=1,this.ns=1,this.es=0,this.os=0,this.hs=null,this.rs=!1,this.cs=this.size.t(),this.us=l(),this.ls=0,this.fs=0,this.ds=null,this.ws=!1}moveTo(t,s){this.Kt=this.nt.t(),this.Qt=t;const i=this.Kt.u(this.Qt)/s;return this.Vt=A,this.Xt=A+i,this.Yt=!0,new Promise((t=>this.Zt=t))}gs(t,s){return this.ss=this.color.a,this.ns=t,this.es=A,this.os=A+s,this.ts=!0,new Promise((t=>this.hs=t))}resizeTo(t,s){return this.cs=this.size.t(),this.us=t,this.ls=A,this.fs=A+s,this.rs=!0,new Promise((t=>this.ds=t))}vs(){if(!this.Yt)return;if(A>=this.Xt)return this.nt=this.Qt.t(),this.Yt=!1,this.Zt(this),void(this.Zt=null);const t=h(A,this.Vt,this.Xt);this.nt=this.Kt.k(this.Qt,t)}ps(){if(!this.ts)return;if(A>=this.os)return this.color.a=this.ns,this.ts=!1,this.hs(this),void(this.hs=null);const t=h(A,this.es,this.os);this.color.a=r(t,this.ss,this.ns)}Ms(){if(!this.rs)return;if(A>=this.fs)return this.size=this.us.t(),this.rs=!1,this.ds(this),void(this.ds=null);const t=h(A,this.ls,this.fs);this.size=this.cs.k(this.us,t)}update(){this.vs(),this.ps(),this.Ms()}it(){E(this.nt,this.size,21,void 0,this.color)}}let Ps,Fs,Hs,Ws,Us,Ns=l(),zs=null,Bs=null,Es=l(),Is=null,Ls=null;const _s=l(0,-8);let qs=[];const Gs=l(),Js=l();let Os=l();const js="Place houses! Must touch a road, not overlap\nother houses, and be within the grid",Ys=new ms,Ks=new vs(l(0,-4),l(5,3),"Done",1.5,new f(1,1,1),new f(0,0,0),(()=>{Ps.xt&&ps.ft(ls)}),!1);Ys.X(Ks);const Qs=new ms,Vs=new vs(l(0,-5),l(5,3),"Rotate",1.2,new f(1,1,1),new f(0,0,0),(()=>{Us.rotate(1)}),!1);Qs.X(Vs);const Xs=new vs(Vs.nt.add(l(0,-4)),l(5,3),"Skip",1.5,new f(1,1,1),new f(0,0,0),(()=>{Hs>0&&(Us=null,Hs-=1,Is.gs(0,2),Is.moveTo(_s.t().add(l(20,0)),10).then((t=>t.ws=!0)),ps.ft(ls)),Hs<=0&&(Xs.enabled=!1)}),!1);Qs.X(Xs);const Zs={lower:l(),upper:l()},ti=Xs.nt.i(Xs.size.o(l(2))).add(l(1)),si=Vs.nt.add(Vs.size.o(l(2))).add(l(1));function ii(){for(let t=0;t<qs.length;t++){const s=qs[t];s.update(),s.ws&&(qs.splice(t,1),t--)}}const ni={init(){Ps=new Cs(15,15),zs=null,Bs=null,Us=null;const t=Ps.Wt();v.x=Ps.nt.x+t.x/2-1,v.y=Ps.nt.y+t.y/2-1,Ks.nt.x=Ps.nt.x+t.x/2-1,Ks.enabled=!1,Gs.x=Ks.nt.x,Gs.y=Ps.nt.y+t.y-1+5,Js.x=Ks.nt.x,Js.y=Ks.nt.y-4,Hs=3;const s=Ps.Rt();Zs.lower=s[0].i(l(8)),Zs.upper=s[1].add(l(8)),Es.x=Ps.nt.x+t.x/2-1,Es.y=-8,_s.x=Ps.nt.x+t.x-5,qs=[]},wt(){if(O(0)&&!Ys.pressed()&&(Bs=Ps.Nt(),Bs)){Ps.At();const t=Ps.Ut();Fs=t.type===Vt||t.type===ts?Zt:Xt}if(j(0)){if(Ys.st(),Bs){Ps.Et();const t=Ps.Nt(!0);Fs===Xt?Ps.Bt(Bs,t,Vt):Ps.Bt(Bs,t,Kt),Ps.It(),Ps._t(),Ks.enabled=Ps.xt}Bs=null}if(J(0)&&Bs){Ps.Et();const t=Ps.Nt(!0);Ps.Bt(Bs,t,Fs)}},gt(){Ps.it(),q("Make roads by clicking and dragging lines\non the grid. Delete by clicking and dragging\non existing roads",Gs,1.5),Ps.xt||q("All roads must connect to an edge of the grid",Js,1.5),Ys.it()}},ei={init(){Xs.enabled=!1,Vs.enabled=!1,Is=new Ds(l(40,-20)),Is.moveTo(_s,15).then((()=>{ps.ft(as)})),qs.push(Is)},wt(){ii()},gt(){Ps.it(),Us&&Us.it();for(const t of qs)t.it();q(js,Gs,1.5),q("right-click\nworks too",Vs.nt.add(l(3,.5)),1,void 0,void 0,void 0,"left"),q(`Skips left: ${Hs}`,Xs.nt.add(l(3,0)),1.5,void 0,void 0,void 0,"left"),Qs.it()}},oi={init(){Xs.enabled=Hs>0,Vs.enabled=!0,Ps.Pt(),Us=new Ts(Es.t()),Ls=Ps.Tt(Us)},wt(){if(ii(),j(2)&&Us.rotate(1),O(0)&&!Qs.pressed()&&Us.jt()&&(Us.state=ss,Ns=Us.nt.t(),zs=Y.t()),j(0)&&(Qs.st(),zs)){Us.nt.x=2*Math.floor((Us.nt.x+1)/2),Us.nt.y=2*Math.floor((Us.nt.y+1)/2);const t=Us.Rt(),s=l((t[0].x+t[1].x)/2,(t[0].y+t[1].y)/2);s.x>=ti.x&&s.x<=si.x&&s.y>=ti.y&&s.y<=si.y&&(Us.nt.x=Ns.x,Us.nt.y=Ns.y),Ps.Ct(Us)&&Ps.Dt(Us)?(Ps.Ft(Us),Is.resizeTo(l(1),1),Is.moveTo(s.t(),10).then((t=>t.gs(0,1))).then((t=>{t.ws=!0})),Us=null,ps.ft(ls)):Us.state=ns,zs=null}if(J(0)&&zs){Us.nt.x=Ns.x+(Y.x-zs.x),Us.nt.y=Ns.y+(Y.y-zs.y);const t=Us.Rt();t[0].x<Zs.lower.x?Us.nt.x=Zs.lower.x:t[1].x>Zs.upper.x&&(Us.nt.x=Zs.upper.x-(t[1].x-t[0].x)),t[0].y<Zs.lower.y?Us.nt.y=Zs.lower.y:t[1].y>Zs.upper.y&&(Us.nt.y=Zs.upper.y-(t[1].y-t[0].y))}ps.lt===as&&(!Ps.bt||!Ls&&Hs<=0)&&ps.ft(fs)},gt(){Ps.it();for(const t of qs)t.it();Us.it(),q(js,Gs,1.5),q("right-click\nworks too",Vs.nt.add(l(3,.5)),1,void 0,void 0,void 0,"left"),q(`Skips left: ${Hs}`,Xs.nt.add(l(3,0)),1.5,void 0,void 0,void 0,"left"),Qs.it()}},hi={init(){Vs.enabled=!1,Xs.enabled=!1,Ws=Date.now()},wt(){ii();const s=Date.now(),i=s-Ws;if(Os=((s=1)=>(new a).p(c(2*t),s))(r(h(i,0,1e3),1,0)),i>=3e3){const t=Ps.qt();ps.ft(ds,{timestamp:s,ys:t.Gt,Ss:t.Jt,Ot:t.Ot})}},gt(){Ps.it(),Us.it();for(const t of qs)t.it();q("Game over! No more space or skips",Gs.add(Os),1.5),q("right-click\nworks too",Vs.nt.add(l(3,.5)),1,new f(1,1,1,.5),void 0,void 0,"left"),q(`Skips left: ${Hs}`,Xs.nt.add(l(3,0)),1.5,new f(1,1,1,.5),void 0,void 0,"left"),Qs.it()}},ri=new f(1,0,0),ci=new f(1,1,1),ui=new f(1,1,1),li=new f(1,1,0),ai="deathestate_jayther_ldb",fi={};let di,wi=[],gi=0,mi=0,vi=!0;const pi=l(0,18),Mi=pi.add(l(0,-5)),yi=pi.add(l(0,-13)),Si=yi.add(l(3,-5)),ki=new Array(5);for(let t=0;t<ki.length;t++)ki[t]=[Si.add(l(-.7,-2*t)),Si.add(l(.7,-2*t))];const xi=new ms,bi=new vs(pi.add(l(0,-31)),l(5,3),"Retry",1.5,new f(1,1,1),new f(0,0,0),(()=>{ps.ft(us)}),!1);function Ai(t,s){for(di={Ss:t,timestamp:s,ks:new Date(s).toLocaleDateString(),xs:!0},wi.push(di),wi.sort(((t,s)=>{const i=s.Ss-t.Ss;return 0===i?s.timestamp-t.timestamp:i}));wi.length>5;)wi.pop();!function(){const t=wi.map((t=>({Ss:t.Ss,timestamp:t.timestamp}))),s=JSON.stringify(t);if(vi)try{window.localStorage.setItem(ai,s)}catch(t){vi=!1}vi||(fi[ai]=s)}()}xi.X(bi);const Ci=[{init(){},wt(){},gt(){}},Ss,ni,ei,oi,hi,{init(t){gi=t.ys,mi=t.Ot,function(){let t=null;if(vi)try{t=window.localStorage.getItem(ai)}catch(t){vi=!1}else t=fi[ai]||null;t&&(wi=JSON.parse(t)),wi.forEach((t=>t.ks=new Date(t.timestamp).toLocaleDateString()))}(),Ai(t.Ss,t.timestamp),v.x=0,v.y=0},wt(){O(0)&&xi.pressed(),j(0)&&xi.st()},gt(){!function(){q("Game over",pi,4,ri,.5,ci),q(`You covered ${di.Ss} tiles (${Math.floor(di.Ss/gi*100)}%)\n(road count: ${mi}, grid total: ${gi})`,Mi,2,ui),q("High Scores",yi,4,ri,.5,ci);for(let t=0;t<5;t++){const s=wi[t];let i,n,e;s?(i=s.ks,n=s.Ss.toString(),e=s.xs?li:ui):(i="-------------",n="---",e=ui),q(i,ki[t][0],2,e,void 0,void 0,"right"),q(n,ki[t][1],2,e,void 0,void 0,"left")}}(),xi.it()}}],Ri=680,$i=940,Ti=p;!function(t,s,n,e,o,h){P.onerror=P.onload=()=>{S=l(m).o(y=l(P.width,P.height)),document.body.style="margin:0;overflow:hidden;background:#000;touch-action:none;user-select:none;-webkit-user-select:none;-moz-user-select:none",document.body.appendChild(F=document.createElement("canvas")),H=F.getContext("2d"),F.style=T,function(){0;at=document.createElement("canvas"),ft=at.getContext("webgl",{antialias:!1}),at.style=T,dt=function(t){if(!t||!t.width)return;const s=ft.createTexture();return ft.bindTexture(Dt,s),ft.texImage2D(Dt,0,Ht,Ht,Pt,t),ft.texParameteri(Dt,Nt,Wt),ft.texParameteri(Dt,Ut,Wt),ft.texParameteri(Dt,zt,It),ft.texParameteri(Dt,Bt,It),s}(P),document.body.appendChild(at),gt=function(t,s){0;const i=ft.createProgram();ft.attachShader(i,kt(t,Gt)),ft.attachShader(i,kt(s,qt)),ft.linkProgram(i),0;return i}("precision highp float;uniform mat4 m;attribute vec2 p,t;attribute vec4 c,a;varying vec2 v;varying vec4 d,e;void main(){gl_Position=m*vec4(p,1,1);v=t;d=c;e=a;}","precision highp float;varying vec2 v;varying vec4 d,e;uniform sampler2D s;void main(){gl_FragColor=texture2D(s,v)*d+e;}");const t=new ArrayBuffer(jt*Jt*Yt);(function(t,s,i){0;const n=ft.createBuffer();ft.bindBuffer(t,n),ft.bufferData(t,s,i)})(Lt,t.byteLength,_t),mt=new Float32Array(t),vt=new Uint32Array(t);let s=pt=0;const i=(t,i,n,e,o=0)=>{const h=ft.getAttribLocation(gt,t);ft.enableVertexAttribArray(h),ft.vertexAttribPointer(h,e,i,o,Yt,s),s+=e*n};i("p",Ft,4,2),i("t",Ft,4,2),i("c",Pt,1,4,1),i("a",Pt,1,4,1)}(),document.body.appendChild(W=document.createElement("canvas")),U=W.getContext("2d"),W.style=T,t(),r()};const r=(t=0)=>{let h=t-R;if(R=t,C+=h/1e3,$=i($+!0*h,50),w.x){W.width=F.width=w.x,W.height=F.height=w.y;const t=innerWidth/innerHeight,s=F.width/F.height;F.style.width=W.style.width=t<s?"100%":"",F.style.height=W.style.height=t<s?"":"100%",at&&(at.style.width=F.style.width,at.style.height=F.style.height)}else W.width=F.width=i(innerWidth,d.x),W.height=F.height=i(innerHeight,d.y);N=l(F.width,F.height);{let t=0;for($<0&&$>-9&&(t=$,$=0);$>=0;$-=1e3/60)tt(),s(),D(),n(),st();$+=t}N=l(F.width,F.height),H.imageSmoothingEnabled=!1,function(t,s,i,n,e){var o;ft.viewport(0,0,at.width=t,at.height=s),ft.clear(Et),ft.bindTexture(Dt,wt=dt),ft.useProgram(gt),yt=o;const h=2*e/t,r=2*e/s;ft.uniformMatrix4fv(ft.getUniformLocation(gt,"m"),0,new Float32Array([h,0,0,0,0,r,0,0,1,1,-1,1,-1-h*i,-1-r*n,0,0]))}(F.width,F.height,v.x,v.y,p),e(),k.sort(((t,s)=>t.bs-s.bs));for(const t of k)t.U||t.it();o(),function(){if(!St.length)return;const t=St[0],s=C-lt;if(lt)if(s>5)St.shift(lt=0);else{const i=4.5,n=s<M?1-s/M:s>i?(s-i)/M:0;t.it(n)}else lt=C}(),function(t,s){if(!pt&&!s)return;xt(),s&&t.drawImage(at,0,0)}(H),requestAnimationFrame(r)};h?P.src=h:P.onload()}((function(){Pi(),ps.init(Ci),ps.ft(cs)}),(function(){ps.wt()}),(function(){}),(function(){ps.gt()}),(function(){}),"t.png");let Di=null;function Pi(){const t=Ri/$i>innerWidth/innerHeight?innerWidth/Ri:innerHeight/$i;!function(t){p=t}(Ti*t)}window.addEventListener("resize",(function(){clearTimeout(Di),Di=setTimeout(Pi,200)}),!1)}();
      </script>
  </body>
</html>
