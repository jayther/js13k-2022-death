<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Death Estate</title>
      <style>
        a,abbr,acronym,address,applet,article,aside,audio,b,big,blockquote,body,canvas,caption,center,cite,code,dd,del,details,dfn,div,dl,dt,em,embed,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,html,i,iframe,img,ins,kbd,label,legend,li,mark,menu,nav,object,ol,output,p,pre,q,ruby,s,samp,section,small,span,strike,strong,sub,summary,sup,table,tbody,td,tfoot,th,thead,time,tr,tt,u,ul,var,video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:after,blockquote:before,q:after,q:before{content:'';content:none}table{border-collapse:collapse;border-spacing:0}
      </style>
  </head>
  <body>
      <script>
        !function(){"use strict";const t=Math.PI,n=t=>t<0?-t:t,e=(t,n)=>t<n?t:n,s=(t,n)=>t>n?t:n,i=t=>t<0?-1:1,o=(t,n=0,e=1)=>t<n?n:t>e?e:t,r=(t,n=0,e=1)=>e-n?o((t-n)/(e-n)):0,h=(t,n=0,e=1)=>n+o(t)*(e-n),c=(t=1,n=0)=>n+(t-n)*Math.random(),u=(t=1,n=0)=>0|c(t,n),a=(t=0,n)=>null==t.x?new l(t,null==n?t:n):new l(t.x,t.y);class l{constructor(t=0,n=0){this.x=t,this.y=n}t(){return new l(this.x,this.y)}add(t){return new l(this.x+t.x,this.y+t.y)}i(t){return new l(this.x-t.x,this.y-t.y)}multiply(t){return new l(this.x*t.x,this.y*t.y)}o(t){return new l(this.x/t.x,this.y/t.y)}scale(t){return new l(this.x*t,this.y*t)}length(){return this.h()**.5}h(){return this.x**2+this.y**2}u(t){return this.l(t)**.5}l(t){return(this.x-t.x)**2+(this.y-t.y)**2}normalize(t=1){const n=this.length();return n?this.scale(t/n):new l(0,t)}g(t=1){const n=this.length();return n>t?this.scale(t/n):this}m(t){return this.x*t.x+this.y*t.y}v(t){return this.x*t.y-this.y*t.x}angle(){return Math.atan2(this.x,this.y)}p(t=0,n=1){return this.x=n*Math.sin(t),this.y=n*Math.cos(t),this}rotate(t){const n=Math.cos(t),e=Math.sin(t);return new l(this.x*n-this.y*e,this.x*e+this.y*n)}direction(){return n(this.x)>n(this.y)?this.x<0?3:1:this.y<0?2:0}M(){return new l(this.y,-this.x)}floor(){return new l(Math.floor(this.x),Math.floor(this.y))}S(){return n(this.x*this.y)}k(t,n){return this.add(t.i(this).scale(o(n)))}A(t){return this.x>=0&&this.y>=0&&this.x<t.x&&this.y<t.y}toString(t=3){return`(${(this.x<0?"":" ")+this.x.toFixed(t)},${(this.y<0?"":" ")+this.y.toFixed(t)} )`}}class f{constructor(t=1,n=1,e=1,s=1){this.r=t,this.C=n,this.b=e,this.a=s}t(){return new f(this.r,this.C,this.b,this.a)}add(t){return new f(this.r+t.r,this.C+t.C,this.b+t.b,this.a+t.a)}i(t){return new f(this.r-t.r,this.C-t.C,this.b-t.b,this.a-t.a)}multiply(t){return new f(this.r*t.r,this.C*t.C,this.b*t.b,this.a*t.a)}o(t){return new f(this.r/t.r,this.C/t.C,this.b/t.b,this.a/t.a)}scale(t,n=t){return new f(this.r*t,this.C*t,this.b*t,this.a*n)}R(){return new f(o(this.r),o(this.C),o(this.b),o(this.a))}k(t,n){return this.add(t.i(this).scale(o(n)))}$(t=0,n=0,e=1,s=1){const i=e<.5?e*(1+n):e+n-e*n,o=2*e-i,r=(t,n,e)=>(e=(e%1+1)%1)<1/6?t+6*(n-t)*e:e<.5?n:e<2/3?t+(n-t)*(2/3-e)*6:t;return this.r=r(o,i,t+1/3),this.C=r(o,i,t),this.b=r(o,i,t-1/3),this.a=s,this}D(){const t=this.r,n=this.C,e=this.b,s=this.a,i=Math.max(t,n,e),o=Math.min(t,n,e),r=(i+o)/2;let h=0,c=0;if(i!=o){let s=i-o;c=r>.5?s/(2-i-o):s/(i+o),t==i?h=(n-e)/s+(n<e?6:0):n==i?h=(e-t)/s+2:e==i&&(h=(t-n)/s+4)}return[h/6,c,r,s]}H(t=.05,n=0){return new f(this.r+c(t,-t),this.C+c(t,-t),this.b+c(t,-t),this.a+c(n,-n)).R()}toString(){return`rgb(${255*this.r|0},${255*this.C|0},${255*this.b|0},${this.a})`}W(){return(255*this.r|0)+(255*this.C<<8)+(255*this.b<<16)+(255*this.a<<24)}F(t){const n=n=>parseInt(t.slice(n,n+2),16)/255;return this.r=n(1),this.C=n(3),this.b=n(5),this.a=1,this}T(){const t=t=>((t=255*t|0)<16?"0":"")+t.toString(16);return"#"+t(this.r)+t(this.C)+t(this.b)}}let d=a(1920,1200),w=a(),g=a(16),m=.3,v=(a(1),a()),p=s(g.x,g.y);let M=.5;let y,S,x=[],k=[],b=0,A=0,C=0,R=0,$=0;const D="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)";function H(){k=x.filter((t=>t.P));const t=n=>{if(!n.U){n.update();for(const e of n.children)t(e)}};for(const n of x)n.parent||t(n);x=x.filter((t=>!t.U)),A=++b/60}const W=new Image;let F,T,P,U,N=a();const B=t=>t.add(a(.5)).i(N.scale(.5)).multiply(a(1/p,-1/p)).add(v),z=t=>t.i(v).multiply(a(p,-p)).add(N.scale(.5)).i(a(.5));function E(t,n=a(1),e=-1,s=g,i=new f,o=0,r,h=new f(0,0,0,0),c=1){if(c)if(e<0||!W.width)bt(t.x,t.y,n.x,n.y,o,0,0,0,0,0,i.W());else{const c=y.x/s.x|0,u=s.x/y.x,a=s.y/y.y,l=e%c*u,f=(e/c|0)*a;bt(t.x,t.y,r?-n.x:n.x,n.y,o,l+S.x,f+S.y,l-S.x+u,f-S.y+a,i.W(),h.W())}else!function(t,n,e,s,i,o=T){t=z(t),n=n.scale(p),o.save(),o.translate(t.x+.5|0,t.y-.5|0),o.rotate(e),o.scale(s?-n.x:n.x,n.y),i(o),o.restore()}(t,n,o,r,(t=>{if(e<0)t.fillStyle=i,t.fillRect(-.5,-.5,1,1);else{const n=y.x/s.x|0,o=e%n*s.x+m,r=(e/n|0)*s.y+m,h=s.x-.6,c=s.y-.6;t.globalAlpha=i.a,t.drawImage(W,o,r,h,c,-.5,-.5,1,1)}}))}function I(t,n,e,s,i){E(t,n,-1,g,e,s,0,0,i)}function L(t,n,e,s,i){!function(t,n=a(1),e,s,i,o,r,h,c){E(B(t),n.scale(1/p),e,s,i,o,r,h,c)}(t,n,-1,g,e,s,0,0,i)}function _(t,n,e=1,s=new f,i=0,o=new f(0,0,0),r="center",h="arial"){U.fillStyle=s,U.lineWidth=i,U.strokeStyle=o,U.textAlign=r,U.font=e+"px "+h,U.textBaseline="middle",U.lineJoin="round",n=n.t(),(t+"").split("\n").forEach((t=>{i&&U.strokeText(t,n.x,n.y),U.fillText(t,n.x,n.y),n.y+=e}))}function q(t,n,e=1,s,i,o,r,h){_(t,z(n),e*p,s,i*p,o,r,h)}const G=(t,n=0)=>Z[n]&&1&Z[n][t]?1:0,J=G,O=(t,n=0)=>Z[n]&&2&Z[n][t]?1:0,j=(t,n=0)=>Z[n]&&4&Z[n][t]?1:0;let Y=a(),K=a(),Q=0,V=0;const X=(t,n=0)=>G(t,n+1);let Z=[[]];function tt(){document.hasFocus()||(Z=[[]]),Y=B(K),function(){0;if(!navigator.getGamepads||!document.hasFocus())return;const t=navigator.getGamepads();for(let n=t.length;n--;){const e=t[n],s=Z[n+1]||(Z[n+1]=[]),i=it[n]||(it[n]=[]);if(e){const t=.3,o=.8,h=n=>n>t?r(n,t,o):n<-t?-r(-n,t,o):0;for(let t=0;t<e.axes.length-1;t+=2)i[t>>1]=a(h(e.axes[t]),h(-e.axes[t+1])).g();for(let t=e.buttons.length;t--;){const i=e.buttons[t];s[t]=i.pressed?1+2*!X(t,n):4*X(t,n),V|=!n&&i.pressed}{const t=a(X(15,n)-X(14,n),X(12,n)-X(13,n));t.h()&&(i[0]=t.g())}}}}()}function nt(){for(const t of Z)for(const n in t)t[n]&=1;Q=0}onkeydown=t=>{t.repeat||(Z[V=0][et(t.keyCode)]=3)},onkeyup=t=>{Z[0][et(t.keyCode)]=4};const et=t=>87==t?38:83==t?40:65==t?37:68==t?39:t;onmousedown=t=>{Z[V=0][t.button]=3,onmousemove(t),t.button&&t.preventDefault()},onmouseup=t=>Z[0][t.button]=2&Z[0][t.button]|4,onmousemove=t=>K=st(t),onwheel=t=>t.ctrlKey||(Q=i(t.deltaY)),oncontextmenu=t=>!1;const st=t=>{if(!F)return a();const n=F.getBoundingClientRect();return a(F.width,F.height).multiply(a(r(t.x,n.left,n.right),r(t.y,n.top,n.bottom)))},it=[];const ot=void 0!==window.ontouchstart;if(ot){let t,n;ontouchstart=ontouchmove=ontouchend=e=>{e.button=0;const s=e.touches.length;return s?(n||ht(0,n=1),e.x=e.touches[0].clientX,e.y=e.touches[0].clientY,t?onmousemove(e):onmousedown(e)):t&&onmouseup(e),t=s,!e.cancelable}}let rt;new class{constructor(t){this.time=null==t?void 0:A+t,this.setTime=t}set(t=0){this.time=A+t,this.setTime=t}N(){this.time=void 0}B(){return null!=this.time}active(){return A<=this.time}I(){return A>this.time}get(){return this.B()?A-this.time:0}L(){return this.B()?r(this.time-A,this.setTime,0):0}toString(){0}},a();const ht=(...t)=>function(t,n=1,e=1,s=0,i=0){if(rt||(rt=new(window.AudioContext||webkitAudioContext)),rt.resume(),"running"!=rt.state)return;const r=rt.createBuffer(t.length,t[0].length,ct),h=rt.createBufferSource();t.forEach(((t,n)=>r.getChannelData(n).set(t))),h.buffer=r,h.playbackRate.value=e,h.loop=i;const c=rt.createGain();return c.gain.value=.5*n,c.connect(rt.destination),(window.StereoPannerNode?h.connect(new StereoPannerNode(rt,{pan:o(s,-1,1)})):h).connect(c),h.start(),h}([ut(...t)]),ct=44100;function ut(o=1,r=.05,h=220,u=0,a=0,l=.1,f=0,d=1,w=0,g=0,m=0,v=0,p=0,M=0,y=0,S=0,x=0,k=1,b=0,A=0){let C,R,$=2*t,D=w*=500*$/ct/ct,H=[],W=h*=(1+r*c(-1,1))*$/ct,F=0,T=0,P=0,U=1,N=0,B=0,z=0;for(g*=500*$/ct**3,y*=$/ct,m*=$/ct,v*=ct,p=p*ct|0,R=(u=u*ct+9)+(b*=ct)+(a*=ct)+(l*=ct)+(x*=ct)|0;P<R;H[P++]=z)++B%(100*S|0)||(z=f?f>1?f>2?f>3?Math.sin((F%$)**3):s(e(Math.tan(F),1),-1):1-(2*F/$%2+2)%2:1-4*n(Math.round(F/$)-F/$):Math.sin(F),z=(p?1-A+A*Math.sin($*P/p):1)*i(z)*n(z)**d*o*.5*(P<u?P/u:P<u+b?1-(P-u)/b*(1-k):P<u+b+a?k:P<R-x?(R-P-x)/l*k:0),z=x?z/2+(x>P?0:(P<R-x?1:(R-P)/x)*H[P-x|0]/2):z),C=(h+=w+=g)*Math.cos(y*T++),F+=C-C*M*(1-1e9*(Math.sin(P)+1)%2),U&&++U>v&&(h+=m,W+=m,U=0),!p||++N%p||(h=W,w=D,U=U||1);return H}a();let at,lt,ft,dt,wt,gt,mt,vt,pt,Mt,yt,St=[];function xt(t,n){const e=ft.createShader(n);return ft.shaderSource(e,t),ft.compileShader(e),e}function kt(){if(!pt)return;const t=Mt?At:$t;ft.blendFuncSeparate(Rt,t,At,t),ft.enable(Dt),ft.bufferSubData(Lt,0,mt.subarray(0,pt*Jt*Ot)),ft.drawArrays(Ct,0,pt*Jt),pt=0,Mt=yt}function bt(t,n,e,s,i,o,r,h,c,u=4294967295,a=0){pt!=jt&&Mt==yt||kt();const l=Math.cos(i)/2,f=Math.sin(i)/2,d=l*e,w=l*s,g=f*e,m=f*s;let v=pt++*Jt*Ot;mt[v++]=t-d-m,mt[v++]=n-w+g,mt[v++]=o,mt[v++]=c,vt[v++]=u,vt[v++]=a,mt[v++]=t+d+m,mt[v++]=n+w-g,mt[v++]=h,mt[v++]=r,vt[v++]=u,vt[v++]=a,mt[v++]=t-d+m,mt[v++]=n+w+g,mt[v++]=o,mt[v++]=r,vt[v++]=u,vt[v++]=a,mt[v++]=t-d-m,mt[v++]=n-w+g,mt[v++]=o,mt[v++]=c,vt[v++]=u,vt[v++]=a,mt[v++]=t+d-m,mt[v++]=n-w-g,mt[v++]=h,mt[v++]=c,vt[v++]=u,vt[v++]=a,mt[v++]=t+d+m,mt[v++]=n+w-g,mt[v++]=h,mt[v++]=r,vt[v++]=u,vt[v++]=a}const At=1,Ct=4,Rt=770,$t=771,Dt=3042,Ht=3553,Wt=5121,Ft=5126,Tt=6408,Pt=9728,Ut=10240,Nt=10241,Bt=10242,zt=10243,Et=16384,It=33071,Lt=34962,_t=35048,qt=35632,Gt=35633,Jt=6,Ot=6,jt=65536,Yt=24,Kt=0,Qt=1,Vt=2,Xt=3,Zt=4,tn=5,nn=0,en=1,sn=2,on=3,rn=[[0,1],[1,0],[0,-1],[-1,0]],hn=rn.concat([[1,1],[1,-1],[-1,-1],[-1,1]]),cn=0,un=1,an=2,ln=3,fn=4,dn=5,wn={_:1,q:2,G:4,J:8,O:16,j:32,Y:64,K:128},gn=[wn._,wn.q,wn.G,wn.J,wn.O,wn.j,wn.Y,wn.K];class mn{constructor(){this.buttons=[],this.V=null}X(t){this.buttons.push(t)}Z(t){const n=this.buttons.indexOf(t);n>-1&&this.buttons.splice(n,1)}pressed(){this.V=null;for(let t=this.buttons.length-1;t>=0&&!this.V;t--){const n=this.buttons[t];n.tt()&&(this.V=n)}return!!this.V}nt(){return!!this.V&&(this.V.tt()&&this.V.pressed(),this.V=null,!0)}et(){this.buttons.forEach((t=>t.et()))}}class vn{constructor(t,n,e,s,i,o,r,h=!0){this.st=t,this.size=n,this.text=e,this.it=s,this.bgColor=i,this.ot=o,this.rt=r||(()=>{}),this.ht=!0,this.visible=!0,this.ct=h}get enabled(){return this.ht}set enabled(t){this.ht=t,this.bgColor.a=t?1:.5,this.ot.a=t?1:.5}tt(){if(!this.enabled||!this.visible)return!1;const t=this.ct?K:Y;return t.x>=this.st.x-this.size.x/2&&t.y>=this.st.y-this.size.y/2&&t.x<this.st.x+this.size.x/2&&t.y<this.st.y+this.size.y/2}pressed(){this.rt()}et(){if(!this.visible)return;let t,n;this.ct?(t=L,n=_):(t=I,n=q),t(this.st,this.size,this.bgColor),n(this.text,this.st,this.it,this.ot)}}const pn=new class{constructor(){this.ut=null,this.lt=cn}init(t){this.ut=t}ft(t,n){this.lt=t,this.dt=this.ut[t],this.dt.init(n)}wt(){this.dt.wt()}gt(){this.dt.gt()}},Mn=new vn(a(0,-2),a(4,2.5),"Start",1.5,new f(1,1,1),new f(0,0,0),(()=>{pn.ft(an)}),!1),yn=new mn;yn.X(Mn);const Sn={init(){},wt(){O(0)&&yn.pressed(),j(0)&&yn.nt()},gt(){q("Death Estate",a(0,4),5,new f(1,0,0),c(1,1.2),new f(1,1,1)),yn.et()}},xn=[null,null,new f(.6,.6,.6),new f(.5,.5,.5),new f(.8,.3,.3),new f(1,0,0)],kn=[new f(.278,.176,.235),new f(.223,.125,.183)],bn=[null,{index:4,angle:t},{index:4,angle:-t/2},{index:1,angle:-t/2},{index:4,angle:0},{index:0,angle:0},{index:1,angle:0},{index:2,angle:0},{index:4,angle:t/2},{index:1,angle:t},{index:0,angle:t/2},{index:2,angle:-t/2},{index:1,angle:t/2},{index:2,angle:t},{index:2,angle:t/2},{index:3,angle:0}];class An{constructor(t,n,e){this.x=n,this.y=e,this.type=t||0,this.vt=0,this.Mt=!1}t(){return new An(this.type,this.x,this.y)}apply(t){this.type=t.type}}class Cn{constructor(t,n){this.st=a(),this.yt=[],this.St=[],this.xt=[],this.kt=!1,this.bt=!1,this.size=a(t,n);const e=this.size.x*this.size.y;for(let t=0;t<e;t+=1){const n=new An(0,t%this.size.x,Math.floor(t/this.size.y));this.yt.push(n),this.xt.push(n.t())}}At(){this.yt.forEach(((t,n)=>this.xt[n].apply(t)))}Ct(t){const n=t.Rt(),e=this.Rt();if(!(n[0].x>=e[0].x&&n[0].y>=e[0].y&&n[1].x<=e[1].x&&n[1].y<=e[1].y))return!1;const s=t.st.o(a(2)),i=t.yt;for(let t=0;t<i.length;t+=1){const n=i[t];for(let e=0;e<n.length;e+=1){if(!(7&n[e]))continue;const i=s.add(a(e,t)),o=this.$t(i.x,i.y);if(o&&o.type)return!1}}return!0}Dt(t){const n=t.t();n.state=on;for(const t of this.yt){const e=a(t.x,t.y).multiply(a(2));n.st=e;for(let t=0;t<4;t++){if(this.Ct(n)&&this.Ht(n))return n;n.rotate(1)}}return null}Wt(){const t=this.yt.filter((t=>t.type===Vt));for(const n of t)for(const t of rn){const e=a(n.x+t[0],n.y+t[1]),s=this.$t(e.x,e.y);if(s&&s.type===Kt)return void(this.bt=!0)}this.bt=!1}Ht(t){const n=t.st.o(a(2)),e=t.yt;for(let t=0;t<e.length;t+=1){const s=e[t];for(let e=0;e<s.length;e+=1){if(!(7&s[e]))continue;const i=n.add(a(e,t));if(rn.map((t=>this.$t(i.x+t[0],i.y+t[1]))).filter((t=>t)).some((t=>t.type===Vt)))return!0}}return!1}Ft(t){t.state=en,this.St.push(t);const n=t.st.o(a(2)),e=t.yt;for(let t=0;t<e.length;t+=1){const s=e[t];for(let e=0;e<s.length;e+=1){if(!(7&s[e]))continue;const i=n.add(a(e,t));this.Tt(i.x,i.y,Qt)}}}Pt(){return this.size.multiply(a(2))}Rt(){return[this.st.t(),this.st.add(this.size.multiply(a(2)))]}Tt(t,n,e){this.yt[t+n*this.size.x].type=e}$t(t,n){return a(t,n).A(this.size)?this.yt[t+n*this.size.x]:null}Ut(){const t=this.Nt();return t?this.$t(t.x,t.y):null}Nt(t=!1){return this.Bt(Y,t)}Bt(t,n=!1){const e=t.i(this.st).add(a(1));return n||e.A(this.size.multiply(a(2)))?e.o(a(2)).floor():null}zt(t,n,e){const s=[];if(Math.abs(n.x-t.x)<Math.abs(n.y-t.y)){const e=Math.max(Math.min(n.y,t.y),0),i=Math.min(Math.max(n.y,t.y),this.size.y-1);for(let n=e;n<=i;n+=1)s.push(this.$t(t.x,n))}else{const e=Math.max(Math.min(n.x,t.x),0),i=Math.min(Math.max(n.x,t.x),this.size.x-1);for(let n=e;n<=i;n+=1)s.push(this.$t(n,t.y))}for(const t of s)t.type=e;return s}Et(){this.yt.forEach(((t,n)=>t.apply(this.xt[n])))}It(){const t=this.yt.filter((t=>t.type===Vt||t.type===tn));t.forEach((t=>{t.type=tn,t.Mt=!1}));const e=t.filter((t=>0===t.x||0===t.y||t.x===this.size.x-1||t.y===this.size.y-1));if(!e.length)return void(this.kt=!1);const s=[];e.forEach((t=>{s.some((e=>n(e.x-t.x)<=3&&n(e.y-t.y)<=3))&&t.type!==tn||(t.Mt=!0,s.push(t)),this.Lt(t.x,t.y)})),this.kt=t.every((t=>t.type===Vt))}Lt(t,n){const e=this.$t(t,n);if(e&&e.type===tn){e.type=Vt;for(const e of rn)this.Lt(t+e[0],n+e[1])}}_t(){const t=this.yt.filter((t=>t.type===Vt));for(const n of t)n.vt=rn.reduce(((t,e,s)=>{const i=a(n.x+e[0],n.y+e[1]);if(i.A(this.size)){const n=this.$t(i.x,i.y);if(!n||n.type!==Vt)return t}else if(!n.Mt)return t;return t|gn[s]}),0)}qt(){const t=this.size.x*this.size.y;let n=0,e=0;for(const t of this.yt)t.type===Qt?n+=1:t.type===Vt&&(e+=1);return{Gt:t,Jt:n,Ot:e}}et(){for(const t of this.yt){let n=-1,e=0;const s=a(t.x,t.y).multiply(a(2)).add(this.st),i=xn[t.type]||kn[(t.x+t.y)%2];if(t.type===Vt){const s=bn[t.vt];s&&(n=s.index+16,e=s.angle)}n>-1?E(s,a(2),n,void 0,void 0,e):i&&I(s,a(2),i)}for(const t of this.St)t.et()}}const Rn=[new f,new f(.9,.9,.9),new f(1,.3,.3),new f(1,1,1,.5)],$n=a(2);a(1.5);class Dn{constructor(t,n){this.st=t,this.yt=n||function(t){const n=2*t-1,e=u(1,n**2+1),s=[],i=[];for(let t=0;t<n;t++)s.push(new Array(n).fill(Kt));for(let t=0;t<e;t++){let e,o;if(0===t)e=u(0,n),o=u(0,n),i.push([e,o]);else{const t=i[u(0,i.length)],r=rn.map((e=>{let i=[t[0]+e[0],t[1]+e[1]];return i[0]<0||i[0]>=n||i[1]<0||i[1]>=n||s[i[1]][i[0]]!==Kt?null:i})).filter((t=>t));if(!r.length)continue;const h=r[u(0,r.length)];[e,o]=h,i.push(h)}s[o][e]=Qt}for(let t=s.length-1;t>=0;t--)s[t].every((t=>t===Kt))&&s.splice(t,1);for(let t=n-1;t>=0;t--)s.map((n=>n[t])).every((t=>t===Kt))&&s.forEach((n=>n.splice(t,1)));return s}(2),this._t(),this.state=nn}_t(){for(let t=0;t<this.yt.length;t++)for(let n=0;n<this.yt[t].length;n++){const e=a(this.yt[t].length,this.yt.length),s=hn.reduce(((s,i,o)=>{const r=a(n+i[0],t+i[1]);return r.A(e)&&7&this.yt[r.y][r.x]?s|gn[o]:s}),0);this.yt[t][n]=7&this.yt[t][n]|s<<3}}t(){const t=[];for(let n=0;n<this.yt.length;n++)t.push([...this.yt[n]]);return new Dn(this.st.t(),t)}Rt(){const t=2*this.yt[0].length,n=2*this.yt.length;return[this.st.t(),this.st.add(a(t,n))]}jt(){const t=Y.i(this.st).add(a(1)).o(a(2)).floor(),n=this.yt[t.y];return!!n&&!!n[t.x]}rotate(t){const n=this.yt.length,e=this.yt[0].length,s=new Array(e);for(let t=0;t<e;t++)s[t]=new Array(n).fill(Kt);for(let t=0;t<n;t++)for(let n=0;n<e;n++)s[n][t]=this.yt[t][n];1===t?s.reverse():s.forEach((t=>t.reverse())),this.yt=s,this._t()}et(){for(let t=0;t<this.yt.length;t+=1){const n=this.yt[t];for(let e=0;e<n.length;e+=1){const s=n[e];if(!(7&s))continue;Rn[this.state]||new f(1,0,0);E(a(e,t).multiply($n).add(this.st),$n,s>>3&15)}}}}let Hn,Wn,Fn,Tn,Pn,Un=a(),Nn=null,Bn=null,zn=a(),En=null;const In=a(),Ln=a();let _n=a();const qn=new mn,Gn=new vn(a(0,-4),a(5,3),"Done",1.5,new f(1,1,1),new f(0,0,0),(()=>{Hn.kt&&pn.ft(ln)}),!1);qn.X(Gn);const Jn=new mn,On=new vn(a(0,-5),a(5,3),"Rotate",1.2,new f(1,1,1),new f(0,0,0),(()=>{Pn.rotate(1)}),!1);Jn.X(On);const jn=new vn(On.st.add(a(0,-4)),a(5,3),"Skip",1.5,new f(1,1,1),new f(0,0,0),(()=>{Fn>0&&(Fn-=1,Vn()),Fn<=0&&(jn.enabled=!1)}),!1);Jn.X(jn);const Yn={lower:a(),upper:a()},Kn=jn.st.i(jn.size.o(a(2))).add(a(1)),Qn=On.st.add(On.size.o(a(2))).add(a(1));function Vn(){Pn=new Dn(zn.t()),En=Hn.Dt(Pn)}const Xn={init(){Hn=new Cn(15,15),Nn=null,Bn=null;const t=Hn.Pt();v.x=Hn.st.x+t.x/2-1,v.y=Hn.st.y+t.y/2-1,Gn.st.x=Hn.st.x+t.x/2-1,Gn.enabled=!1,In.x=Gn.st.x,In.y=Hn.st.y+t.y-1+5,Ln.x=Gn.st.x,Ln.y=Gn.st.y-4},wt(){if(O(0)&&!qn.pressed()&&(Bn=Hn.Nt(),Bn)){Hn.At();const t=Hn.Ut();Wn=t.type===Vt||t.type===tn?Zt:Xt}if(j(0)){if(qn.nt(),Bn){Hn.Et();const t=Hn.Nt(!0);Wn===Xt?Hn.zt(Bn,t,Vt):Hn.zt(Bn,t,Kt),Hn.It(),Hn._t(),Gn.enabled=Hn.kt}Bn=null}if(J(0)&&Bn){Hn.Et();const t=Hn.Nt(!0);Hn.zt(Bn,t,Wn)}},gt(){Hn.et(),q("Make roads by clicking and dragging lines\non the grid. Delete by clicking and dragging\non existing roads",In,1.5),Hn.kt||q("All roads must connect to an edge of the grid",Ln,1.5),qn.et()}},Zn={init(){const t=Hn.Pt();zn.x=Hn.st.x+t.x/2-1,zn.y=-8,Fn=3,jn.enabled=!0,On.enabled=!0;const n=Hn.Rt();Yn.lower=n[0].i(a(8)),Yn.upper=n[1].add(a(8)),Hn.Wt(),Vn()},wt(){if(j(2)&&Pn.rotate(1),O(0)&&!Jn.pressed()&&Pn.jt()&&(Pn.state=nn,Un=Pn.st.t(),Nn=Y.t()),j(0)&&(Jn.nt(),Nn)){Pn.st.x=2*Math.floor((Pn.st.x+1)/2),Pn.st.y=2*Math.floor((Pn.st.y+1)/2);const t=Pn.Rt(),n=a((t[0].x+t[1].x)/2,(t[0].y+t[1].y)/2);n.x>=Kn.x&&n.x<=Qn.x&&n.y>=Kn.y&&n.y<=Qn.y&&(Pn.st.x=Un.x,Pn.st.y=Un.y),Hn.Ct(Pn)&&Hn.Ht(Pn)?(Hn.Ft(Pn),Hn.Wt(),Vn()):Pn.state=sn,Nn=null}if(J(0)&&Nn){Pn.st.x=Un.x+(Y.x-Nn.x),Pn.st.y=Un.y+(Y.y-Nn.y);const t=Pn.Rt();t[0].x<Yn.lower.x?Pn.st.x=Yn.lower.x:t[1].x>Yn.upper.x&&(Pn.st.x=Yn.upper.x-(t[1].x-t[0].x)),t[0].y<Yn.lower.y?Pn.st.y=Yn.lower.y:t[1].y>Yn.upper.y&&(Pn.st.y=Yn.upper.y-(t[1].y-t[0].y))}(!Hn.bt||!En&&Fn<=0)&&pn.ft(fn)},gt(){Hn.et(),Pn.et(),q("Place houses! Must touch a road, not overlap\nother houses, and be within the grid",In,1.5),q("right-click\nworks too",On.st.add(a(3,.5)),1,void 0,void 0,void 0,"left"),q(`Skips left: ${Fn}`,jn.st.add(a(3,0)),1.5,void 0,void 0,void 0,"left"),Jn.et()}},te={init(){On.enabled=!1,jn.enabled=!1,Tn=Date.now()},wt(){const n=Date.now(),e=n-Tn;if(_n=((n=1)=>(new l).p(c(2*t),n))(h(r(e,0,1e3),1,0)),e>=3e3){const t=Hn.qt();pn.ft(dn,{timestamp:n,Yt:t.Gt,Kt:t.Jt,Ot:t.Ot})}},gt(){Hn.et(),Pn.et(),q("Game over! No more space or skips",In.add(_n),1.5),q("right-click\nworks too",On.st.add(a(3,.5)),1,new f(1,1,1,.5),void 0,void 0,"left"),q(`Skips left: ${Fn}`,jn.st.add(a(3,0)),1.5,new f(1,1,1,.5),void 0,void 0,"left"),Jn.et()}},ne=new f(1,0,0),ee=new f(1,1,1),se=new f(1,1,1),ie=new f(1,1,0),oe="deathestate_jayther_ldb",re={};let he,ce=[],ue=0,ae=0,le=!0;const fe=a(0,18),de=fe.add(a(0,-5)),we=fe.add(a(0,-13)),ge=we.add(a(3,-5)),me=new Array(5);for(let t=0;t<me.length;t++)me[t]=[ge.add(a(-.7,-2*t)),ge.add(a(.7,-2*t))];const ve=new mn,pe=new vn(fe.add(a(0,-31)),a(5,3),"Retry",1.5,new f(1,1,1),new f(0,0,0),(()=>{pn.ft(an)}),!1);function Me(t,n){for(he={Kt:t,timestamp:n,Qt:new Date(n).toLocaleDateString(),Vt:!0},ce.push(he),ce.sort(((t,n)=>{const e=n.Kt-t.Kt;return 0===e?n.timestamp-t.timestamp:e}));ce.length>5;)ce.pop();!function(){const t=ce.map((t=>({Kt:t.Kt,timestamp:t.timestamp}))),n=JSON.stringify(t);if(le)try{window.localStorage.setItem(oe,n)}catch(t){le=!1}le||(re[oe]=n)}()}ve.X(pe);const ye=[{init(){},wt(){},gt(){}},Sn,Xn,Zn,te,{init(t){ue=t.Yt,ae=t.Ot,function(){let t=null;if(le)try{t=window.localStorage.getItem(oe)}catch(t){le=!1}else t=re[oe]||null;t&&(ce=JSON.parse(t)),ce.forEach((t=>t.Qt=new Date(t.timestamp).toLocaleDateString()))}(),Me(t.Kt,t.timestamp),v.x=0,v.y=0},wt(){O(0)&&ve.pressed(),j(0)&&ve.nt()},gt(){!function(){q("Game over",fe,4,ne,.5,ee),q(`You covered ${he.Kt} tiles (${Math.floor(he.Kt/ue*100)}%)\n(road count: ${ae}, grid total: ${ue})`,de,2,se),q("High Scores",we,4,ne,.5,ee);for(let t=0;t<5;t++){const n=ce[t];let e,s,i;n?(e=n.Qt,s=n.Kt.toString(),i=n.Vt?ie:se):(e="-------------",s="---",i=se),q(e,me[t][0],2,i,void 0,void 0,"right"),q(s,me[t][1],2,i,void 0,void 0,"left")}}(),ve.et()}}],Se=680,xe=940,ke=p;!function(t,n,s,i,o,r){W.onerror=W.onload=()=>{S=a(m).o(y=a(W.width,W.height)),document.body.style="margin:0;overflow:hidden;background:#000;touch-action:none;user-select:none;-webkit-user-select:none;-moz-user-select:none",document.body.appendChild(F=document.createElement("canvas")),T=F.getContext("2d"),F.style=D,function(){0;lt=document.createElement("canvas"),ft=lt.getContext("webgl",{antialias:!1}),lt.style=D,dt=function(t){if(!t||!t.width)return;const n=ft.createTexture();return ft.bindTexture(Ht,n),ft.texImage2D(Ht,0,Tt,Tt,Wt,t),ft.texParameteri(Ht,Nt,Pt),ft.texParameteri(Ht,Ut,Pt),ft.texParameteri(Ht,Bt,It),ft.texParameteri(Ht,zt,It),n}(W),document.body.appendChild(lt),gt=function(t,n){0;const e=ft.createProgram();ft.attachShader(e,xt(t,Gt)),ft.attachShader(e,xt(n,qt)),ft.linkProgram(e),0;return e}("precision highp float;uniform mat4 m;attribute vec2 p,t;attribute vec4 c,a;varying vec2 v;varying vec4 d,e;void main(){gl_Position=m*vec4(p,1,1);v=t;d=c;e=a;}","precision highp float;varying vec2 v;varying vec4 d,e;uniform sampler2D s;void main(){gl_FragColor=texture2D(s,v)*d+e;}");const t=new ArrayBuffer(jt*Jt*Yt);(function(t,n,e){0;const s=ft.createBuffer();ft.bindBuffer(t,s),ft.bufferData(t,n,e)})(Lt,t.byteLength,_t),mt=new Float32Array(t),vt=new Uint32Array(t);let n=pt=0;const e=(t,e,s,i,o=0)=>{const r=ft.getAttribLocation(gt,t);ft.enableVertexAttribArray(r),ft.vertexAttribPointer(r,i,e,o,Yt,n),n+=i*s};e("p",Ft,4,2),e("t",Ft,4,2),e("c",Wt,1,4,1),e("a",Wt,1,4,1)}(),document.body.appendChild(P=document.createElement("canvas")),U=P.getContext("2d"),P.style=D,t(),h()};const h=(t=0)=>{let r=t-R;if(R=t,C+=r/1e3,$=e($+!0*r,50),w.x){P.width=F.width=w.x,P.height=F.height=w.y;const t=innerWidth/innerHeight,n=F.width/F.height;F.style.width=P.style.width=t<n?"100%":"",F.style.height=P.style.height=t<n?"":"100%",lt&&(lt.style.width=F.style.width,lt.style.height=F.style.height)}else P.width=F.width=e(innerWidth,d.x),P.height=F.height=e(innerHeight,d.y);N=a(F.width,F.height);{let t=0;for($<0&&$>-9&&(t=$,$=0);$>=0;$-=1e3/60)tt(),n(),H(),s(),nt();$+=t}N=a(F.width,F.height),T.imageSmoothingEnabled=!1,function(t,n,e,s,i){var o;ft.viewport(0,0,lt.width=t,lt.height=n),ft.clear(Et),ft.bindTexture(Ht,wt=dt),ft.useProgram(gt),yt=o;const r=2*i/t,h=2*i/n;ft.uniformMatrix4fv(ft.getUniformLocation(gt,"m"),0,new Float32Array([r,0,0,0,0,h,0,0,1,1,-1,1,-1-r*e,-1-h*s,0,0]))}(F.width,F.height,v.x,v.y,p),i(),x.sort(((t,n)=>t.Xt-n.Xt));for(const t of x)t.U||t.et();o(),function(){if(!St.length)return;const t=St[0],n=C-at;if(at)if(n>5)St.shift(at=0);else{const e=4.5,s=n<M?1-n/M:n>e?(n-e)/M:0;t.et(s)}else at=C}(),function(t,n){if(!pt&&!n)return;kt(),n&&t.drawImage(lt,0,0)}(T),requestAnimationFrame(h)};r?W.src=r:W.onload()}((function(){Ae(),pn.init(ye),pn.ft(un)}),(function(){pn.wt()}),(function(){}),(function(){pn.gt()}),(function(){}),"t.png");let be=null;function Ae(){const t=Se/xe>innerWidth/innerHeight?innerWidth/Se:innerHeight/xe;!function(t){p=t}(ke*t)}window.addEventListener("resize",(function(){clearTimeout(be),be=setTimeout(Ae,200)}),!1)}();
      </script>
  </body>
</html>
