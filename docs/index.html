<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Death Estate</title>
      <style>
        body,canvas,div,html{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}body{line-height:1}
      </style>
  </head>
  <body>
      <script>
        !function(){"use strict";const t=Math.PI,s=t=>t<0?-t:t,i=(t,s)=>t<s?t:s,n=(t,s)=>t>s?t:s,e=t=>t<0?-1:1,o=(t,s=0,i=1)=>t<s?s:t>i?i:t,h=(t,s=0,i=1)=>i-s?o((t-s)/(i-s)):0,r=(t,s=0,i=1)=>s+o(t)*(i-s),c=(t=1,s=0)=>s+(t-s)*Math.random(),u=(t=1,s=0)=>0|c(t,s),l=(t=0,s)=>null==t.x?new a(t,null==s?t:s):new a(t.x,t.y);class a{constructor(t=0,s=0){this.x=t,this.y=s}t(){return new a(this.x,this.y)}add(t){return new a(this.x+t.x,this.y+t.y)}i(t){return new a(this.x-t.x,this.y-t.y)}multiply(t){return new a(this.x*t.x,this.y*t.y)}o(t){return new a(this.x/t.x,this.y/t.y)}scale(t){return new a(this.x*t,this.y*t)}length(){return this.h()**.5}h(){return this.x**2+this.y**2}u(t){return this.l(t)**.5}l(t){return(this.x-t.x)**2+(this.y-t.y)**2}normalize(t=1){const s=this.length();return s?this.scale(t/s):new a(0,t)}g(t=1){const s=this.length();return s>t?this.scale(t/s):this}m(t){return this.x*t.x+this.y*t.y}v(t){return this.x*t.y-this.y*t.x}angle(){return Math.atan2(this.x,this.y)}p(t=0,s=1){return this.x=s*Math.sin(t),this.y=s*Math.cos(t),this}rotate(t){const s=Math.cos(t),i=Math.sin(t);return new a(this.x*s-this.y*i,this.x*i+this.y*s)}direction(){return s(this.x)>s(this.y)?this.x<0?3:1:this.y<0?2:0}M(){return new a(this.y,-this.x)}floor(){return new a(Math.floor(this.x),Math.floor(this.y))}k(){return s(this.x*this.y)}S(t,s){return this.add(t.i(this).scale(o(s)))}T(t){return this.x>=0&&this.y>=0&&this.x<t.x&&this.y<t.y}toString(t=3){return`(${(this.x<0?"":" ")+this.x.toFixed(t)},${(this.y<0?"":" ")+this.y.toFixed(t)} )`}}class f{constructor(t=1,s=1,i=1,n=1){this.r=t,this.A=s,this.b=i,this.a=n}t(){return new f(this.r,this.A,this.b,this.a)}add(t){return new f(this.r+t.r,this.A+t.A,this.b+t.b,this.a+t.a)}i(t){return new f(this.r-t.r,this.A-t.A,this.b-t.b,this.a-t.a)}multiply(t){return new f(this.r*t.r,this.A*t.A,this.b*t.b,this.a*t.a)}o(t){return new f(this.r/t.r,this.A/t.A,this.b/t.b,this.a/t.a)}scale(t,s=t){return new f(this.r*t,this.A*t,this.b*t,this.a*s)}C(){return new f(o(this.r),o(this.A),o(this.b),o(this.a))}S(t,s){return this.add(t.i(this).scale(o(s)))}R(t=0,s=0,i=1,n=1){const e=i<.5?i*(1+s):i+s-i*s,o=2*i-e,h=(t,s,i)=>(i=(i%1+1)%1)<1/6?t+6*(s-t)*i:i<.5?s:i<2/3?t+(s-t)*(2/3-i)*6:t;return this.r=h(o,e,t+1/3),this.A=h(o,e,t),this.b=h(o,e,t-1/3),this.a=n,this}D(){const t=this.r,s=this.A,i=this.b,n=this.a,e=Math.max(t,s,i),o=Math.min(t,s,i),h=(e+o)/2;let r=0,c=0;if(e!=o){let n=e-o;c=h>.5?n/(2-e-o):n/(e+o),t==e?r=(s-i)/n+(s<i?6:0):s==e?r=(i-t)/n+2:i==e&&(r=(t-s)/n+4)}return[r/6,c,h,n]}$(t=.05,s=0){return new f(this.r+c(t,-t),this.A+c(t,-t),this.b+c(t,-t),this.a+c(s,-s)).C()}toString(){return`rgb(${255*this.r|0},${255*this.A|0},${255*this.b|0},${this.a})`}F(){return(255*this.r|0)+(255*this.A<<8)+(255*this.b<<16)+(255*this.a<<24)}P(t){const s=s=>parseInt(t.slice(s,s+2),16)/255;return this.r=s(1),this.A=s(3),this.b=s(5),this.a=1,this}H(){const t=t=>((t=255*t|0)<16?"0":"")+t.toString(16);return"#"+t(this.r)+t(this.A)+t(this.b)}}let d=l(1920,1200),w=l(),g=l(16),m=.3,v=(l(1),l()),p=n(g.x,g.y);let M=.5;let y,k,S=[],x=[],b=0,T=0,A=0,C=0,R=0;const D="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)";function $(){x=S.filter((t=>t.W));const t=s=>{if(!s.U){s.update();for(const i of s.children)t(i)}};for(const s of S)s.parent||t(s);S=S.filter((t=>!t.U)),T=++b/60}const F=new Image;let P,H,W,U,N=l();const z=t=>t.add(l(.5)).i(N.scale(.5)).multiply(l(1/p,-1/p)).add(v),q=t=>t.i(v).multiply(l(p,-p)).add(N.scale(.5)).i(l(.5));function B(t,s=l(1),i=-1,n=g,e=new f,o=0,h,r=new f(0,0,0,0),c=1){if(c)if(i<0||!F.width)At(t.x,t.y,s.x,s.y,o,0,0,0,0,0,e.F());else{const c=y.x/n.x|0,u=n.x/y.x,l=n.y/y.y,a=i%c*u,f=(i/c|0)*l;At(t.x,t.y,h?-s.x:s.x,s.y,o,a+k.x,f+k.y,a-k.x+u,f-k.y+l,e.F(),r.F())}else!function(t,s,i,n,e,o=H){t=q(t),s=s.scale(p),o.save(),o.translate(t.x+.5|0,t.y-.5|0),o.rotate(i),o.scale(n?-s.x:s.x,s.y),e(o),o.restore()}(t,s,o,h,(t=>{if(i<0)t.fillStyle=e,t.fillRect(-.5,-.5,1,1);else{const s=y.x/n.x|0,o=i%s*n.x+m,h=(i/s|0)*n.y+m,r=n.x-.6,c=n.y-.6;t.globalAlpha=e.a,t.drawImage(F,o,h,r,c,-.5,-.5,1,1)}}))}function I(t,s,i,n,e){B(t,s,-1,g,i,n,0,0,e)}function E(t,s,i,n,e){!function(t,s=l(1),i,n,e,o,h,r,c){B(z(t),s.scale(1/p),i,n,e,o,h,r,c)}(t,s,-1,g,i,n,0,0,e)}function L(t,s,i=1,n=new f,e=0,o=new f(0,0,0),h="center",r="arial"){U.fillStyle=n,U.lineWidth=e,U.strokeStyle=o,U.textAlign=h,U.font=i+"px "+r,U.textBaseline="middle",U.lineJoin="round",s=s.t(),(t+"").split("\n").forEach((t=>{e&&U.strokeText(t,s.x,s.y),U.fillText(t,s.x,s.y),s.y+=i}))}function _(t,s,i=1,n,e,o,h,r){L(t,q(s),i*p,n,e*p,o,h,r)}const G=(t,s=0)=>Z[s]&&1&Z[s][t]?1:0,J=G,O=(t,s=0)=>Z[s]&&2&Z[s][t]?1:0,j=(t,s=0)=>Z[s]&&4&Z[s][t]?1:0;let Y=l(),K=l(),Q=0,V=0;const X=(t,s=0)=>G(t,s+1);let Z=[[]];function tt(){document.hasFocus()||(Z=[[]]),Y=z(K),function(){0;if(!navigator.getGamepads||!document.hasFocus())return;const t=navigator.getGamepads();for(let s=t.length;s--;){const i=t[s],n=Z[s+1]||(Z[s+1]=[]),e=et[s]||(et[s]=[]);if(i){const t=.3,o=.8,r=s=>s>t?h(s,t,o):s<-t?-h(-s,t,o):0;for(let t=0;t<i.axes.length-1;t+=2)e[t>>1]=l(r(i.axes[t]),r(-i.axes[t+1])).g();for(let t=i.buttons.length;t--;){const e=i.buttons[t];n[t]=e.pressed?1+2*!X(t,s):4*X(t,s),V|=!s&&e.pressed}{const t=l(X(15,s)-X(14,s),X(12,s)-X(13,s));t.h()&&(e[0]=t.g())}}}}()}function st(){for(const t of Z)for(const s in t)t[s]&=1;Q=0}onkeydown=t=>{t.repeat||(Z[V=0][it(t.keyCode)]=3)},onkeyup=t=>{Z[0][it(t.keyCode)]=4};const it=t=>87==t?38:83==t?40:65==t?37:68==t?39:t;onmousedown=t=>{Z[V=0][t.button]=3,onmousemove(t),t.button&&t.preventDefault()},onmouseup=t=>Z[0][t.button]=2&Z[0][t.button]|4,onmousemove=t=>K=nt(t),onwheel=t=>t.ctrlKey||(Q=e(t.deltaY)),oncontextmenu=t=>!1;const nt=t=>{if(!P)return l();const s=P.getBoundingClientRect();return l(P.width,P.height).multiply(l(h(t.x,s.left,s.right),h(t.y,s.top,s.bottom)))},et=[];const ot=void 0!==window.ontouchstart;if(ot){let t,s;ontouchstart=ontouchmove=ontouchend=i=>{i.button=0;const n=i.touches.length;return n?(s||ut(0,s=1),i.x=i.touches[0].clientX,i.y=i.touches[0].clientY,t?onmousemove(i):onmousedown(i)):t&&onmouseup(i),t=n,!i.cancelable}}let ht;new class{constructor(t){this.time=null==t?void 0:T+t,this.setTime=t}set(t=0){this.time=T+t,this.setTime=t}N(){this.time=void 0}q(){return null!=this.time}active(){return T<=this.time}B(){return T>this.time}get(){return this.q()?T-this.time:0}I(){return this.q()?h(this.time-T,this.setTime,0):0}toString(){0}},l();class rt{constructor(t,s=30,i=.7){this.range=s,this.L=i,this._=t[1]||0,t[1]=0,this.G=at(...t)}play(t,s=1,i=1,n=1){let e=0;if(t){const i=this.range;if(i){const n=v.l(t);if(n>i*i)return;s*=h(n**.5,i,i*this.L)}e=2*q(t).x/P.width-1}const o=i+i*this._*n*c(-1,1);return ct([this.G],s,o,e)}J(t,s,i=1){return this.play(s,i,2**(t/12),0)}}function ct(t,s=1,i=1,n=0,e=0){if(ht||(ht=new(window.AudioContext||webkitAudioContext)),ht.resume(),"running"!=ht.state)return;const h=ht.createBuffer(t.length,t[0].length,lt),r=ht.createBufferSource();t.forEach(((t,s)=>h.getChannelData(s).set(t))),r.buffer=h,r.playbackRate.value=i,r.loop=e;const c=ht.createGain();return c.gain.value=.5*s,c.connect(ht.destination),(window.StereoPannerNode?r.connect(new StereoPannerNode(ht,{pan:o(n,-1,1)})):r).connect(c),r.start(),r}const ut=(...t)=>ct([at(...t)]),lt=44100;function at(o=1,h=.05,r=220,u=0,l=0,a=.1,f=0,d=1,w=0,g=0,m=0,v=0,p=0,M=0,y=0,k=0,S=0,x=1,b=0,T=0){let A,C,R=2*t,D=w*=500*R/lt/lt,$=[],F=r*=(1+h*c(-1,1))*R/lt,P=0,H=0,W=0,U=1,N=0,z=0,q=0;for(g*=500*R/lt**3,y*=R/lt,m*=R/lt,v*=lt,p=p*lt|0,C=(u=u*lt+9)+(b*=lt)+(l*=lt)+(a*=lt)+(S*=lt)|0;W<C;$[W++]=q)++z%(100*k|0)||(q=f?f>1?f>2?f>3?Math.sin((P%R)**3):n(i(Math.tan(P),1),-1):1-(2*P/R%2+2)%2:1-4*s(Math.round(P/R)-P/R):Math.sin(P),q=(p?1-T+T*Math.sin(R*W/p):1)*e(q)*s(q)**d*o*.5*(W<u?W/u:W<u+b?1-(W-u)/b*(1-x):W<u+b+l?x:W<C-S?(C-W-S)/a*x:0),q=S?q/2+(S>W?0:(W<C-S?1:(C-W)/S)*$[W-S|0]/2):q),A=(r+=w+=g)*Math.cos(y*H++),P+=A-A*M*(1-1e9*(Math.sin(W)+1)%2),U&&++U>v&&(r+=m,F+=m,U=0),!p||++N%p||(r=F,w=D,U=U||1);return $}l();let ft,dt,wt,gt,mt,vt,pt,Mt,yt,kt,St,xt=[];function bt(t,s){const i=wt.createShader(s);return wt.shaderSource(i,t),wt.compileShader(i),i}function Tt(){if(!yt)return;const t=kt?Ct:$t;wt.blendFuncSeparate(Dt,t,Ct,t),wt.enable(Ft),wt.bufferSubData(_t,0,pt.subarray(0,yt*jt*Yt)),wt.drawArrays(Rt,0,yt*jt),yt=0,kt=St}function At(t,s,i,n,e,o,h,r,c,u=4294967295,l=0){yt!=Kt&&kt==St||Tt();const a=Math.cos(e)/2,f=Math.sin(e)/2,d=a*i,w=a*n,g=f*i,m=f*n;let v=yt++*jt*Yt;pt[v++]=t-d-m,pt[v++]=s-w+g,pt[v++]=o,pt[v++]=c,Mt[v++]=u,Mt[v++]=l,pt[v++]=t+d+m,pt[v++]=s+w-g,pt[v++]=r,pt[v++]=h,Mt[v++]=u,Mt[v++]=l,pt[v++]=t-d+m,pt[v++]=s+w+g,pt[v++]=o,pt[v++]=h,Mt[v++]=u,Mt[v++]=l,pt[v++]=t-d-m,pt[v++]=s-w+g,pt[v++]=o,pt[v++]=c,Mt[v++]=u,Mt[v++]=l,pt[v++]=t+d-m,pt[v++]=s-w-g,pt[v++]=r,pt[v++]=c,Mt[v++]=u,Mt[v++]=l,pt[v++]=t+d+m,pt[v++]=s+w-g,pt[v++]=r,pt[v++]=h,Mt[v++]=u,Mt[v++]=l}const Ct=1,Rt=4,Dt=770,$t=771,Ft=3042,Pt=3553,Ht=5121,Wt=5126,Ut=6408,Nt=9728,zt=10240,qt=10241,Bt=10242,It=10243,Et=16384,Lt=33071,_t=34962,Gt=35048,Jt=35632,Ot=35633,jt=6,Yt=6,Kt=65536,Qt=24,Vt=0,Xt=1,Zt=2,ts=3,ss=4,is=5,ns=0,es=1,os=2,hs=3,rs=[[0,1],[1,0],[0,-1],[-1,0]],cs=(rs.concat([[1,1],[1,-1],[-1,-1],[-1,1]]),0),us=1,ls=2,as=3,fs=4,ds=5,ws=6,gs={O:1,j:2,Y:4,K:8,V:16,X:32,Z:64,tt:128},ms=[gs.O,gs.j,gs.Y,gs.K,gs.V,gs.X,gs.Z,gs.tt];class vs{constructor(){this.buttons=[],this.st=null}it(t){this.buttons.push(t)}nt(t){const s=this.buttons.indexOf(t);s>-1&&this.buttons.splice(s,1)}pressed(){this.st=null;for(let t=this.buttons.length-1;t>=0&&!this.st;t--){const s=this.buttons[t];s.et()&&(this.st=s)}return!!this.st}ot(){return!!this.st&&(this.st.et()&&this.st.pressed(),this.st=null,!0)}ht(){this.buttons.forEach((t=>t.ht()))}}const ps=new rt([2.77,,21,,.02,.01,3,.23,72,27,-13,.07,,,,.1,,.36]),Ms=new rt([1.01,,402,.02,.04,.08,2,1.24,-14,,,,,,,,,.56,.07]),ys=new rt([1.54,,438,.02,.04,.19,,1.49,-6.9,,,,,.1,,.3,.01,.85,.01]),ks=new rt([,,167,.01,.01,.01,2,.06,,,,,,,,.1,,,,.01]),Ss=new rt([,,86,.01,.01,.01,2,.06,,,,,,,,.1,,,,.01]),xs=new rt([1.73,,389,,.09,.13,1,1.89,,,-455,.01,,,,,.01,.74,.05,.08]);class bs{constructor(t,s,i,n,e,o,h,r=!0,c=!0){this.rt=t,this.size=s,this.text=i,this.ct=n,this.bgColor=e,this.ut=o,this.lt=h||(()=>{}),this.ft=c,this.dt=!0,this.visible=!0,this.wt=r}get enabled(){return this.dt}set enabled(t){this.dt=t,this.bgColor.a=t?1:.5,this.ut.a=t?1:.5}et(){if(!this.enabled||!this.visible)return!1;const t=this.wt?K:Y;return t.x>=this.rt.x-this.size.x/2&&t.y>=this.rt.y-this.size.y/2&&t.x<this.rt.x+this.size.x/2&&t.y<this.rt.y+this.size.y/2}pressed(){this.lt(),this.ft&&ps.play()}ht(){if(!this.visible)return;let t,s;this.wt?(t=E,s=L):(t=I,s=_),t(this.rt,this.size,this.bgColor),s(this.text,this.rt,this.ct,this.ut)}}const Ts=["Can you build me this?","Please make this for me?","I would like this house!"],As=["Thank you!","Thanks so much!","Appreciate it!","<3"],Cs=["Aww...","Darn...","Fine then...",":("];function Rs(t){return t[u(0,t.length)]}class Ds{constructor(t){this.rt=t,this.color=new f(1,1,1,1),this.size=l(6),this.text=null,this.gt=!1,this.vt=t.t(),this.Mt=l(),this.yt=0,this.kt=0,this.St=null,this.xt=!1,this.bt=1,this.Tt=1,this.At=0,this.Ct=0,this.Rt=null,this.Dt=!1,this.$t=this.size.t(),this.Ft=l(),this.Pt=0,this.Ht=0,this.Wt=null,this.Ut=!1}moveTo(t,s){this.vt=this.rt.t(),this.Mt=t;const i=this.vt.u(this.Mt)/s;return this.yt=T,this.kt=T+i,this.gt=!0,new Promise((t=>this.St=t))}Nt(t,s){return this.bt=this.color.a,this.Tt=t,this.At=T,this.Ct=T+s,this.xt=!0,new Promise((t=>this.Rt=t))}resizeTo(t,s){return this.$t=this.size.t(),this.Ft=t,this.Pt=T,this.Ht=T+s,this.Dt=!0,new Promise((t=>this.Wt=t))}zt(){this.text=Rs(Ts)}qt(){this.text=Rs(As),setTimeout((()=>this.text=null),1500)}Bt(){this.text=Rs(Cs)}It(){if(!this.gt)return;if(T>=this.kt)return this.rt=this.Mt.t(),this.gt=!1,this.St(this),void(this.St=null);const t=h(T,this.yt,this.kt);this.rt=this.vt.S(this.Mt,t)}Et(){if(!this.xt)return;if(T>=this.Ct)return this.color.a=this.Tt,this.xt=!1,this.Rt(this),void(this.Rt=null);const t=h(T,this.At,this.Ct);this.color.a=r(t,this.bt,this.Tt)}Lt(){if(!this.Dt)return;if(T>=this.Ht)return this.size=this.Ft.t(),this.Dt=!1,this.Wt(this),void(this.Wt=null);const t=h(T,this.Pt,this.Ht);this.size=this.$t.S(this.Ft,t)}update(){this.It(),this.Et(),this.Lt()}ht(){B(this.rt,this.size,21,void 0,this.color),this.text&&_(this.text,this.rt.add(l(0,this.size.y/2+1)),1,this.color)}}const $s=[new f(1,1,1,.3),null,new f(1,0,0,.5),new f(1,1,1,.5)],Fs=l(2);class Ps{constructor(t,s){this.rt=t,this._t=s||function(t){const s=2*t-1,i=u(1,s**2+1),n=[],e=[];for(let t=0;t<s;t++)n.push(new Array(s).fill(Vt));for(let t=0;t<i;t++){let i,o;if(0===t)i=u(0,s),o=u(0,s),e.push([i,o]);else{const t=e[u(0,e.length)],h=rs.map((i=>{let e=[t[0]+i[0],t[1]+i[1]];return e[0]<0||e[0]>=s||e[1]<0||e[1]>=s||n[e[1]][e[0]]!==Vt?null:e})).filter((t=>t));if(!h.length)continue;const r=h[u(0,h.length)];[i,o]=r,e.push(r)}n[o][i]=Xt}for(let t=n.length-1;t>=0;t--)n[t].every((t=>t===Vt))&&n.splice(t,1);for(let t=s-1;t>=0;t--)n.map((s=>s[t])).every((t=>t===Vt))&&n.forEach((s=>s.splice(t,1)));return n}(2),this.Gt(),this.state=ns}Gt(){for(let t=0;t<this._t.length;t++)for(let s=0;s<this._t[t].length;s++){const i=l(this._t[t].length,this._t.length),n=rs.reduce(((n,e,o)=>{const h=l(s+e[0],t+e[1]);return h.T(i)&&7&this._t[h.y][h.x]?n|ms[o]:n}),0);this._t[t][s]=7&this._t[t][s]|n<<3}}t(){const t=[];for(let s=0;s<this._t.length;s++)t.push([...this._t[s]]);return new Ps(this.rt.t(),t)}Jt(){const t=2*this._t[0].length,s=2*this._t.length;return[this.rt.t(),this.rt.add(l(t,s))]}Ot(){const t=Y.i(this.rt).add(l(1)).o(l(2)).floor(),s=this._t[t.y];return!!s&&!!s[t.x]}rotate(t){const s=this._t.length,i=this._t[0].length,n=new Array(i);for(let t=0;t<i;t++)n[t]=new Array(s).fill(Vt);for(let t=0;t<s;t++)for(let s=0;s<i;s++)n[s][t]=this._t[t][s];1===t?n.reverse():n.forEach((t=>t.reverse())),this._t=n,this.Gt()}ht(){for(let t=0;t<this._t.length;t+=1){const s=this._t[t];for(let i=0;i<s.length;i+=1){const n=s[i];if(!(7&n))continue;const e=$s[this.state],o=l(i,t).multiply(Fs).add(this.rt);B(o,Fs,n>>3),e&&I(o,Fs,e)}}}}const Hs=new class{constructor(){this.jt=null,this.Yt=cs}init(t){this.jt=t}Kt(t,s){this.Yt=t,this.Qt=this.jt[t],this.Qt.init(s)}Vt(){this.Qt.Vt()}Xt(){this.Qt.Xt()}},Ws=new bs(l(0,-10),l(4,2.5),"Start",1.5,new f(1,1,1),new f(0,0,0),(()=>{Hs.Kt(ls)}),!1),Us=new vs;Us.it(Ws);const Ns=l(5,0),zs=l(-5,0),qs=new Ds(Ns.t());qs.size=l(10);let Bs=null,Is=0;function Es(){Bs=new Ps(l());const t=Bs.Jt(),s=l((t[0].x+t[1].x)/2,(t[0].y+t[1].y)/2),i=Bs.rt.i(s);Bs.rt.x=zs.x+i.x,Bs.rt.y=zs.y+i.y}const Ls={init(){Es()},Vt(){const s=Math.sin(T*t*2/.5)/2+.5,i=Math.sin(T*t*2/1.3),n=Math.sin(T*t*2/2.1);qs.color.a=1-.2*s,qs.rt=Ns.add(l(1*i,1*n)),T-Is>=1&&(Es(),Is=T),O(0)&&Us.pressed(),j(0)&&Us.ot()},Xt(){Bs&&Bs.ht(),qs.ht();const s=Math.sin(T*t*2/3)/2+.5;_("Death Estate",l(0,10),5,new f(1,0,0),1+.2*s,new f(1,1,1)),Us.ht()}},_s=[null,null,new f(.6,.6,.6),new f(.5,.5,.5),new f(.8,.3,.3),new f(1,0,0)],Gs=[new f(.278,.176,.235),new f(.223,.125,.183)],Js=[null,{index:4,angle:t},{index:4,angle:-t/2},{index:1,angle:-t/2},{index:4,angle:0},{index:0,angle:0},{index:1,angle:0},{index:2,angle:0},{index:4,angle:t/2},{index:1,angle:t},{index:0,angle:t/2},{index:2,angle:-t/2},{index:1,angle:t/2},{index:2,angle:t},{index:2,angle:t/2},{index:3,angle:0}];class Os{constructor(t,s,i){this.x=s,this.y=i,this.type=t||0,this.Zt=0,this.ts=!1}t(){return new Os(this.type,this.x,this.y)}apply(t){this.type=t.type}}class js{constructor(t,s){this.rt=l(),this._t=[],this.ss=[],this.ns=[],this.es=!1,this.os=!1,this.size=l(t,s);const i=this.size.x*this.size.y;for(let t=0;t<i;t+=1){const s=new Os(0,t%this.size.x,Math.floor(t/this.size.y));this._t.push(s),this.ns.push(s.t())}}hs(){this._t.forEach(((t,s)=>this.ns[s].apply(t)))}rs(t){const s=t.Jt(),i=this.Jt();if(!(s[0].x>=i[0].x&&s[0].y>=i[0].y&&s[1].x<=i[1].x&&s[1].y<=i[1].y))return!1;const n=t.rt.o(l(2)),e=t._t;for(let t=0;t<e.length;t+=1){const s=e[t];for(let i=0;i<s.length;i+=1){if(!(7&s[i]))continue;const e=n.add(l(i,t)),o=this.cs(e.x,e.y);if(o&&o.type)return!1}}return!0}us(t){const s=t.t();s.state=hs;for(const t of this._t){const i=l(t.x,t.y).multiply(l(2));s.rt=i;for(let t=0;t<4;t++){if(this.rs(s)&&this.ls(s))return s;s.rotate(1)}}return null}fs(){const t=this._t.filter((t=>t.type===Zt));for(const s of t)for(const t of rs){const i=l(s.x+t[0],s.y+t[1]),n=this.cs(i.x,i.y);if(n&&n.type===Vt)return void(this.os=!0)}this.os=!1}ls(t){const s=t.rt.o(l(2)),i=t._t;for(let t=0;t<i.length;t+=1){const n=i[t];for(let i=0;i<n.length;i+=1){if(!(7&n[i]))continue;const e=s.add(l(i,t));if(rs.map((t=>this.cs(e.x+t[0],e.y+t[1]))).filter((t=>t)).some((t=>t.type===Zt)))return!0}}return!1}ds(t){t.state=es,this.ss.push(t);const s=t.rt.o(l(2)),i=t._t;for(let t=0;t<i.length;t+=1){const n=i[t];for(let i=0;i<n.length;i+=1){if(!(7&n[i]))continue;const e=s.add(l(i,t));this.ws(e.x,e.y,Xt)}}}gs(){return this.size.multiply(l(2))}Jt(){return[this.rt.t(),this.rt.add(this.size.multiply(l(2)))]}ws(t,s,i){this._t[t+s*this.size.x].type=i}cs(t,s){return l(t,s).T(this.size)?this._t[t+s*this.size.x]:null}vs(){const t=this.ps();return t?this.cs(t.x,t.y):null}ps(t=!1){return this.Ms(Y,t)}Ms(t,s=!1){const i=t.i(this.rt).add(l(1));return s||i.T(this.size.multiply(l(2)))?i.o(l(2)).floor():null}ys(t,s,i){const n=[];if(Math.abs(s.x-t.x)<Math.abs(s.y-t.y)){const i=Math.max(Math.min(s.y,t.y),0),e=Math.min(Math.max(s.y,t.y),this.size.y-1);for(let s=i;s<=e;s+=1)n.push(this.cs(t.x,s))}else{const i=Math.max(Math.min(s.x,t.x),0),e=Math.min(Math.max(s.x,t.x),this.size.x-1);for(let s=i;s<=e;s+=1)n.push(this.cs(s,t.y))}for(const t of n)t.type=i;return n}ks(){this._t.forEach(((t,s)=>t.apply(this.ns[s])))}Ss(){const t=this._t.filter((t=>t.type===Zt||t.type===is));t.forEach((t=>{t.type=is,t.ts=!1}));const i=t.filter((t=>0===t.x||0===t.y||t.x===this.size.x-1||t.y===this.size.y-1));if(!i.length)return void(this.es=!1);const n=[];i.forEach((t=>{n.some((i=>s(i.x-t.x)<=3&&s(i.y-t.y)<=3))&&t.type!==is||(t.ts=!0,n.push(t)),this.xs(t.x,t.y)})),this.es=t.every((t=>t.type===Zt))}xs(t,s){const i=this.cs(t,s);if(i&&i.type===is){i.type=Zt;for(const i of rs)this.xs(t+i[0],s+i[1])}}Gt(){const t=this._t.filter((t=>t.type===Zt));for(const s of t)s.Zt=rs.reduce(((t,i,n)=>{const e=l(s.x+i[0],s.y+i[1]);if(e.T(this.size)){const s=this.cs(e.x,e.y);if(!s||s.type!==Zt)return t}else if(!s.ts)return t;return t|ms[n]}),0)}bs(){const t=this.size.x*this.size.y;let s=0,i=0;for(const t of this._t)t.type===Xt?s+=1:t.type===Zt&&(i+=1);return{Ts:t,As:s,Cs:i}}ht(){for(const t of this._t){let s=-1,i=0;const n=l(t.x,t.y).multiply(l(2)).add(this.rt),e=_s[t.type]||Gs[(t.x+t.y)%2];if(t.type===Zt){const n=Js[t.Zt];n&&(s=n.index+16,i=n.angle)}s>-1?B(n,l(2),s,void 0,void 0,i):e&&I(n,l(2),e)}for(const t of this.ss)t.ht()}}let Ys,Ks,Qs,Vs,Xs,Zs=l(),ti=null,si=null,ii=l(),ni=null,ei=null;const oi=l(0,-8);let hi=[];const ri=l(),ci=l();let ui=l();const li="Drag and drop the ghosts' house requests! Must touch\na road, not overlap other houses, and be within the grid",ai=new vs,fi=new bs(l(0,-4),l(5,3),"Done",1.5,new f(1,1,1),new f(0,0,0),(()=>{Ys.es&&Hs.Kt(as)}),!1);ai.it(fi);const di=new vs,wi=new bs(l(0,-5),l(5,3),"Rotate",1.2,new f(1,1,1),new f(0,0,0),(()=>{Xs.rotate(1)}),!1);di.it(wi);const gi=new bs(wi.rt.add(l(0,-4)),l(5,3),"Skip",1.5,new f(1,1,1),new f(0,0,0),(()=>{Qs>0&&(Xs=null,Qs-=1,ys.play(),ni.Bt(),ni.Nt(0,2),ni.moveTo(oi.t().add(l(20,0)),10).then((t=>t.Ut=!0)),Hs.Kt(as)),Qs<=0&&(gi.enabled=!1)}),!1,!1);di.it(gi);const mi={lower:l(),upper:l()},vi=gi.rt.i(gi.size.o(l(2))).add(l(1)),pi=wi.rt.add(wi.size.o(l(2))).add(l(1));function Mi(){for(let t=0;t<hi.length;t++){const s=hi[t];s.update(),s.Ut&&(hi.splice(t,1),t--)}}const yi={init(){Ys=new js(15,15),ti=null,si=null,Xs=null;const t=Ys.gs();v.x=Ys.rt.x+t.x/2-1,v.y=Ys.rt.y+t.y/2-1,fi.rt.x=Ys.rt.x+t.x/2-1,fi.enabled=!1,ri.x=fi.rt.x,ri.y=Ys.rt.y+t.y-1+5,ci.x=fi.rt.x,ci.y=fi.rt.y-4,Qs=3;const s=Ys.Jt();mi.lower=s[0].i(l(8)),mi.upper=s[1].add(l(8)),ii.x=Ys.rt.x+t.x/2-1,ii.y=-8,oi.x=Ys.rt.x+t.x-5,hi=[]},Vt(){if(O(0)&&!ai.pressed()&&(si=Ys.ps(),si)){Ys.hs();const t=Ys.vs();Ks=t.type===Zt||t.type===is?ss:ts}if(j(0)){if(ai.ot(),si){Ys.ks();const t=Ys.ps(!0);Ks===ts?(Ys.ys(si,t,Zt),Ss.play()):(Ys.ys(si,t,Vt),xs.play()),Ys.Ss(),Ys.Gt(),fi.enabled=Ys.es}si=null}if(J(0)&&si){Ys.ks();const t=Ys.ps(!0);Ys.ys(si,t,Ks)}},Xt(){Ys.ht(),_("Make roads by clicking and dragging lines\non the grid. Delete by clicking and dragging\non existing roads",ri,1.5),Ys.es||_("All roads must connect to an edge of the grid",ci,1.5),ai.ht()}},ki={init(){gi.enabled=!1,wi.enabled=!1,ni=new Ds(l(40,-20)),ni.moveTo(oi,15).then((()=>{Hs.Kt(fs)})),hi.push(ni)},Vt(){Mi()},Xt(){Ys.ht(),Xs&&Xs.ht();for(const t of hi)t.ht();_(li,ri,1.5),_("right-click\nworks too",wi.rt.add(l(3,.5)),1,void 0,void 0,void 0,"left"),_(`Skips left: ${Qs}`,gi.rt.add(l(3,0)),1.5,void 0,void 0,void 0,"left"),di.ht()}},Si={init(){gi.enabled=Qs>0,wi.enabled=!0,ni.zt(),Ys.fs(),Ms.play(),Xs=new Ps(ii.t()),ei=Ys.us(Xs)},Vt(){if(Mi(),j(2)&&(Xs.rotate(1),ps.play()),O(0)&&!di.pressed()&&Xs.Ot()&&(ks.play(),Xs.state=ns,Zs=Xs.rt.t(),ti=Y.t()),j(0)&&(di.ot(),ti)){Xs.rt.x=2*Math.floor((Xs.rt.x+1)/2),Xs.rt.y=2*Math.floor((Xs.rt.y+1)/2);const t=Xs.Jt(),s=l((t[0].x+t[1].x)/2,(t[0].y+t[1].y)/2);s.x>=vi.x&&s.x<=pi.x&&s.y>=vi.y&&s.y<=pi.y&&(Xs.rt.x=Zs.x,Xs.rt.y=Zs.y),Ys.rs(Xs)&&Ys.ls(Xs)?(Ss.play(),Ys.ds(Xs),ni.qt(),ni.resizeTo(l(1),1),ni.moveTo(s.t(),10).then((t=>t.Nt(0,1))).then((t=>{t.Ut=!0})),Xs=null,Hs.Kt(as)):(xs.play(),Xs.state=os),ti=null}if(J(0)&&ti){Xs.rt.x=Zs.x+(Y.x-ti.x),Xs.rt.y=Zs.y+(Y.y-ti.y);const t=Xs.Jt();t[0].x<mi.lower.x?Xs.rt.x=mi.lower.x:t[1].x>mi.upper.x&&(Xs.rt.x=mi.upper.x-(t[1].x-t[0].x)),t[0].y<mi.lower.y?Xs.rt.y=mi.lower.y:t[1].y>mi.upper.y&&(Xs.rt.y=mi.upper.y-(t[1].y-t[0].y))}Hs.Yt===fs&&(!Ys.os||!ei&&Qs<=0)&&(ni&&(ni.Bt(),ni.Nt(0,2),ni.moveTo(oi.t().add(l(20,0)),10).then((t=>t.Ut=!0))),ys.play(),Hs.Kt(ds))},Xt(){Ys.ht();for(const t of hi)t.ht();Xs.ht(),_(li,ri,1.5),_("right-click\nworks too",wi.rt.add(l(3,.5)),1,void 0,void 0,void 0,"left"),_(`Skips left: ${Qs}`,gi.rt.add(l(3,0)),1.5,void 0,void 0,void 0,"left"),di.ht()}},xi={init(){wi.enabled=!1,gi.enabled=!1,Vs=Date.now()},Vt(){Mi();const s=Date.now(),i=s-Vs;if(ui=((s=1)=>(new a).p(c(2*t),s))(r(h(i,0,1e3),1,0)),i>=3e3){const t=Ys.bs();Hs.Kt(ws,{timestamp:s,Rs:t.Ts,Ds:t.As,Cs:t.Cs})}},Xt(){Ys.ht(),Xs.ht();for(const t of hi)t.ht();_("Game over! No more space or skips",ri.add(ui),1.5),_("right-click\nworks too",wi.rt.add(l(3,.5)),1,new f(1,1,1,.5),void 0,void 0,"left"),_(`Skips left: ${Qs}`,gi.rt.add(l(3,0)),1.5,new f(1,1,1,.5),void 0,void 0,"left"),di.ht()}},bi=new f(1,0,0),Ti=new f(1,1,1),Ai=new f(1,1,1),Ci=new f(1,1,0),Ri="deathestate_jayther_ldb",Di={};let $i,Fi=[],Pi=0,Hi=0,Wi=!0;const Ui=l(0,18),Ni=Ui.add(l(0,-5)),zi=Ui.add(l(0,-13)),qi=zi.add(l(3,-5)),Bi=new Array(5);for(let t=0;t<Bi.length;t++)Bi[t]=[qi.add(l(-.7,-2*t)),qi.add(l(.7,-2*t))];const Ii=new vs,Ei=new bs(Ui.add(l(0,-31)),l(5,3),"Retry",1.5,new f(1,1,1),new f(0,0,0),(()=>{Hs.Kt(ls)}),!1);function Li(t,s){for($i={Ds:t,timestamp:s,$s:new Date(s).toLocaleDateString(),Fs:!0},Fi.push($i),Fi.sort(((t,s)=>{const i=s.Ds-t.Ds;return 0===i?s.timestamp-t.timestamp:i}));Fi.length>5;)Fi.pop();!function(){const t=Fi.map((t=>({Ds:t.Ds,timestamp:t.timestamp}))),s=JSON.stringify(t);if(Wi)try{window.localStorage.setItem(Ri,s)}catch(t){Wi=!1}Wi||(Di[Ri]=s)}()}Ii.it(Ei);const _i=[{init(){},Vt(){},Xt(){}},Ls,yi,ki,Si,xi,{init(t){Pi=t.Rs,Hi=t.Cs,function(){let t=null;if(Wi)try{t=window.localStorage.getItem(Ri)}catch(t){Wi=!1}else t=Di[Ri]||null;t&&(Fi=JSON.parse(t)),Fi=Fi.filter((t=>"number"==typeof t.Ds)),Fi.forEach((t=>t.$s=new Date(t.timestamp).toLocaleDateString()))}(),Li(t.Ds,t.timestamp),v.x=0,v.y=0},Vt(){O(0)&&Ii.pressed(),j(0)&&Ii.ot()},Xt(){!function(){_("Game over",Ui,4,bi,.5,Ti),_(`You covered ${$i.Ds} tiles (${Math.floor($i.Ds/Pi*100)}%)\n(road count: ${Hi}, grid total: ${Pi})`,Ni,2,Ai),_("High Scores",zi,4,bi,.5,Ti);for(let t=0;t<5;t++){const s=Fi[t];let i,n,e;s?(i=s.$s,n=s.Ds.toString(),e=s.Fs?Ci:Ai):(i="-------------",n="---",e=Ai),_(i,Bi[t][0],2,e,void 0,void 0,"right"),_(n,Bi[t][1],2,e,void 0,void 0,"left")}}(),Ii.ht()}}],Gi=680,Ji=940,Oi=p;!function(t,s,n,e,o,h){F.onerror=F.onload=()=>{k=l(m).o(y=l(F.width,F.height)),document.body.style="margin:0;overflow:hidden;background:#000;touch-action:none;user-select:none;-webkit-user-select:none;-moz-user-select:none",document.body.appendChild(P=document.createElement("canvas")),H=P.getContext("2d"),P.style=D,function(){0;dt=document.createElement("canvas"),wt=dt.getContext("webgl",{antialias:!1}),dt.style=D,gt=function(t){if(!t||!t.width)return;const s=wt.createTexture();return wt.bindTexture(Pt,s),wt.texImage2D(Pt,0,Ut,Ut,Ht,t),wt.texParameteri(Pt,qt,Nt),wt.texParameteri(Pt,zt,Nt),wt.texParameteri(Pt,Bt,Lt),wt.texParameteri(Pt,It,Lt),s}(F),document.body.appendChild(dt),vt=function(t,s){0;const i=wt.createProgram();wt.attachShader(i,bt(t,Ot)),wt.attachShader(i,bt(s,Jt)),wt.linkProgram(i),0;return i}("precision highp float;uniform mat4 m;attribute vec2 p,t;attribute vec4 c,a;varying vec2 v;varying vec4 d,e;void main(){gl_Position=m*vec4(p,1,1);v=t;d=c;e=a;}","precision highp float;varying vec2 v;varying vec4 d,e;uniform sampler2D s;void main(){gl_FragColor=texture2D(s,v)*d+e;}");const t=new ArrayBuffer(Kt*jt*Qt);(function(t,s,i){0;const n=wt.createBuffer();wt.bindBuffer(t,n),wt.bufferData(t,s,i)})(_t,t.byteLength,Gt),pt=new Float32Array(t),Mt=new Uint32Array(t);let s=yt=0;const i=(t,i,n,e,o=0)=>{const h=wt.getAttribLocation(vt,t);wt.enableVertexAttribArray(h),wt.vertexAttribPointer(h,e,i,o,Qt,s),s+=e*n};i("p",Wt,4,2),i("t",Wt,4,2),i("c",Ht,1,4,1),i("a",Ht,1,4,1)}(),document.body.appendChild(W=document.createElement("canvas")),U=W.getContext("2d"),W.style=D,t(),r()};const r=(t=0)=>{let h=t-C;if(C=t,A+=h/1e3,R=i(R+!0*h,50),w.x){W.width=P.width=w.x,W.height=P.height=w.y;const t=innerWidth/innerHeight,s=P.width/P.height;P.style.width=W.style.width=t<s?"100%":"",P.style.height=W.style.height=t<s?"":"100%",dt&&(dt.style.width=P.style.width,dt.style.height=P.style.height)}else W.width=P.width=i(innerWidth,d.x),W.height=P.height=i(innerHeight,d.y);N=l(P.width,P.height);{let t=0;for(R<0&&R>-9&&(t=R,R=0);R>=0;R-=1e3/60)tt(),s(),$(),n(),st();R+=t}N=l(P.width,P.height),H.imageSmoothingEnabled=!1,function(t,s,i,n,e){var o;wt.viewport(0,0,dt.width=t,dt.height=s),wt.clear(Et),wt.bindTexture(Pt,mt=gt),wt.useProgram(vt),St=o;const h=2*e/t,r=2*e/s;wt.uniformMatrix4fv(wt.getUniformLocation(vt,"m"),0,new Float32Array([h,0,0,0,0,r,0,0,1,1,-1,1,-1-h*i,-1-r*n,0,0]))}(P.width,P.height,v.x,v.y,p),e(),S.sort(((t,s)=>t.Ps-s.Ps));for(const t of S)t.U||t.ht();o(),function(){if(!xt.length)return;const t=xt[0],s=A-ft;if(ft)if(s>5)xt.shift(ft=0);else{const i=4.5,n=s<M?1-s/M:s>i?(s-i)/M:0;t.ht(n)}else ft=A}(),function(t,s){if(!yt&&!s)return;Tt(),s&&t.drawImage(dt,0,0)}(H),requestAnimationFrame(r)};h?F.src=h:F.onload()}((function(){Yi(),Hs.init(_i),Hs.Kt(us)}),(function(){Hs.Vt()}),(function(){}),(function(){Hs.Xt()}),(function(){}),"t.png");let ji=null;function Yi(){const t=Gi/Ji>innerWidth/innerHeight?innerWidth/Gi:innerHeight/Ji;!function(t){p=t}(Oi*t)}window.addEventListener("resize",(function(){clearTimeout(ji),ji=setTimeout(Yi,200)}),!1)}();
      </script>
  </body>
</html>
